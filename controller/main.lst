MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ; $Id: main.asm,v 1.2 2005/07/31 21:31:31 tgipson Exp $
                      00002 
                      00003 
                      00004 
                      00005         list    p=18f2450
                      00006         #include "p18f2450.inc"
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  $Id: P18F2450.INC,v 1.5 2006/12/02 22:21:13 curtiss Exp $
                      00005 ;  MPASM PIC18F2450 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2006 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      01276         LIST
                      00007 
                      00008 
                      00009 
                      00010 ; -----------------------
                      00011 
                      00012 
                      00013 
                      00014 ; -----------------------
                      00015 
                      00016 ;       org     0x0000
                      00017 ;       goto    start
                      00018 
                      00019 ;       org     0x0018
                      00020 ;       goto    start
                      00021 
000800                00022         org     0x800
000800 EF3F F004      00023         goto    start
                      00024 
000818                00025         org     0x818
000818 EF3F F004      00026         goto    start
                      00027 
                      00028 ;org    0x4000
                      00029 
                      00030 #include        "string_m.inc"
                      00001 ; $Id: string_m.inc,v 1.1 2005/07/29 14:58:52 tgipson Exp $
00081C                00002 str_string_ver:
00081C 4924 3A64 7320 00003         DW      "$Id: string_m.inc,v 1.1 2005/07/29 14:58:52 tgipson Exp $\r\n\x00"
       7274 6E69 5F67 
       2E6D 6E69 2C63 
       2076 2E31 2031 
       3032 3530 302F 
       2F37 3932 3120 
       3A34 3835 353A 
       2032 6774 7069 
       6F73 206E 7845 
       2070 0D24 000A 
                      00004 
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00005 ; This is a routine and macro for easily sending a text string to RS232.
                      00006 ; Since it contains a macro, it must be #INCLUDEd BEFORE it is used, but after an ORG xxxx directive.
                      00007 ; Could be easily modified to send the string elsewhere (e.g. LCD or other memory)
                      00008 
                      00009 ; Usage:
                      00010 ; To send a string with label str_test, add the following to your source:
                      00011 ;       sendstring      str_test
                      00012 ;
                      00013 ; Wherever appropriate in your code, add the string as follows:
                      00014 ;       str_test:
                      00015 ;               DW      "This is my string.\r\n\x00"
                      00016 ;
                      00017 ; The string can optionally contain the \r\n (return and linefeed), but MUST end with a null character (
                            \x00).
                      00018 
                      00019 
                      00020 sendstring      macro stringlabel
                      00021         movlw   upper   stringlabel
                      00022         movwf   TBLPTRU
                      00023         movlw   high    stringlabel
                      00024         movwf   TBLPTRH
                      00025         movlw   low             stringlabel
                      00026         movwf   TBLPTRL
                      00027         call    stringsender
                      00028         endm
                      00029 
                      00030 
000858                00031 stringsender:
000858 0009           00032         TBLRD*+
00085A 50F5           00033         movf    TABLAT, W
00085C 66E8           00034         TSTFSZ  WREG
00085E EF32 F004      00035         goto    sendstrbyte
000862 0012           00036         return
                      00037 
000864                00038 sendstrbyte: 
000864 EC87 F006      00039         call    SENDCMNDP2
000868 EF2C F004      00040         goto    stringsender
                      00041 
                      00042 
                      00043 
                      00044 ; ----------
                      00045 
                      00046 pstrcpy macro stringlabel, address
                      00047         movlw   upper   stringlabel
                      00048         movwf   TBLPTRU
                      00049         movlw   high    stringlabel
                      00050         movwf   TBLPTRH
                      00051         movlw   low             stringlabel
                      00052         movwf   TBLPTRL
                      00053 
                      00054         lfsr    FSR0, address
                      00055 
                      00056         call    rom_to_ram
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00057         endm
                      00058 
                      00059 
00086C                00060 rom_to_ram:
00086C 0009           00061         TBLRD*+
00086E 50F5           00062         movf    TABLAT, W
000870 66E8           00063         TSTFSZ  WREG
000872 EF3C F004      00064         goto    rom_to_ram2
000876 0012           00065         return
                      00066 
000878                00067 rom_to_ram2: 
000878 6EEE           00068         movwf   POSTINC0
00087A EF36 F004      00069         goto    rom_to_ram
                      00070 
                      00031 
00087E                00032 start:
00087E 90D1           00033         bcf             WDTCON, SWDTEN
                      00034 
000880 EC4B F005      00035         call    init_ports
000884 EC73 F006      00036         call    INITUSART
                      00037 
000888 EC2C F006      00038         call    delaybit
                      00039 
00088C 0E00           00040         movlw   B'00000000'             ; 8MHz
                      00041 ;       movlw   B'11100000'             ; 4MHz
00088E 6ED3           00042         movwf   OSCCON
                      00043 
000890                00044 testy:
                      00045         sendstring      str_ready
000890 0E00               M         movlw   upper   str_ready
000892 6EF8               M         movwf   TBLPTRU
000894 0E32               M         movlw   high    str_ready
000896 6EF7               M         movwf   TBLPTRH
000898 0E74               M         movlw   low             str_ready
00089A 6EF6               M         movwf   TBLPTRL
00089C EC2C F004          M         call    stringsender
0008A0 EC8C F006      00046         call    SENDCMNDP2CR
                      00047 
0008A4                00048 init:
                      00049 
0008A4 EC7C F007      00050         call    init_int_ADC
                      00051 
0008A8 EC81 F005      00052         call    delaysec
                      00053 
0008AC 8281           00054         bsf             SDIO, ACCEL_PWR
                      00055 
                      00056 
0008AE 0E00           00057         movlw   H'00'
0008B0 6E1F           00058         movwf   ADDR
                      00059 
0008B2 6A1E           00060         clrf    COLOR
0008B4 0E00           00061         movlw   H'00'
0008B6 6E1D           00062         movwf   INTENS
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00063 
                      00064 
0008B8 6A21           00065         clrf    INTENS_R
0008BA 6A22           00066         clrf    INTENS_G
0008BC 6A23           00067         clrf    INTENS_B
                      00068 
                      00069 
                      00070         ;movlw  B'01110000'             ; "all colors off"
                      00071         ;movwf  COMMAND
                      00072         ;call   send1wire
                      00073 
                      00074 ;       call    chain
                      00075 ;       goto    intensloop
0008BE EF8E F004      00076         goto    effecttest
                      00077 
0008C2 EFCF F004      00078         goto    main
                      00079 
0008C6                00080 test_adc:
0008C6 0E00           00081         movlw   H'00'
0008C8 EC6A F007      00082         call    read_int_ADC_chan
0008CC 5018           00083         movf    ANALOGH, w
0008CE ECBE F006      00084         call    SENDHEX
0008D2 5019           00085         movf    ANALOGL, w
0008D4 ECBE F006      00086         call    SENDHEX
0008D8 EC8C F006      00087         call    SENDCMNDP2CR
                      00088 
0008DC 0E0A           00089         movlw   H'0A'
0008DE 2619           00090         addwf   ANALOGL
0008E0 6AE8           00091         clrf    WREG
0008E2 2218           00092         addwfc  ANALOGH
                      00093 
                      00094 
0008E4 B018           00095         btfsc   ANALOGH, 0              ; 'sign'
0008E6 EF7A F004      00096         goto    test_adc_pos
                      00097 
0008EA                00098 test_adc_neg:
0008EA 0E04           00099         movlw   B'00000100'
0008EC 6E1E           00100         movwf   COLOR
0008EE 1E19           00101         comf    ANALOGL         ; invert LSByte
0008F0 EF7C F004      00102         goto    test_adc_show
                      00103 
0008F4                00104 test_adc_pos:
0008F4 0E01           00105         movlw   B'00000001'
0008F6 6E1E           00106         movwf   COLOR   
                      00107 
0008F8                00108 test_adc_show:
0008F8 0E0F           00109         movlw   B'00001111'
0008FA 1619           00110         andwf   ANALOGL
0008FC 90D8           00111         bcf             STATUS, C
0008FE 3219           00112         rrcf    ANALOGL                         ; scale /2
000900 90D8           00113         bcf             STATUS, C
000902 3219           00114         rrcf    ANALOGL                         ; scale /2
000904 90D8           00115         bcf             STATUS, C
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000906 3219           00116         rrcf    ANALOGL                         ; scale /2
                      00117 
000908 C019 F01D      00118         movff   ANALOGL, INTENS
00090C ECFD F004      00119         call    sendcmdbyte
000910 1E1E           00120         comf    COLOR
000912 6A1D           00121         clrf    INTENS
000914 ECFD F004      00122         call    sendcmdbyte
                      00123 
000918 EF63 F004      00124         goto    test_adc
                      00125 
                      00126 
00091C                00127 effecttest:
00091C EC67 F009      00128         call    chain_init
                      00129         sendstring      str_menu
000920 0E00               M         movlw   upper   str_menu
000922 6EF8               M         movwf   TBLPTRU
000924 0E11               M         movlw   high    str_menu
000926 6EF7               M         movwf   TBLPTRH
000928 0EB2               M         movlw   low             str_menu
00092A 6EF6               M         movwf   TBLPTRL
00092C EC2C F004          M         call    stringsender
                      00130         sendstring      str_menu_2
000930 0E00               M         movlw   upper   str_menu_2
000932 6EF8               M         movwf   TBLPTRU
000934 0E12               M         movlw   high    str_menu_2
000936 6EF7               M         movwf   TBLPTRH
000938 0E30               M         movlw   low             str_menu_2
00093A 6EF6               M         movwf   TBLPTRL
00093C EC2C F004          M         call    stringsender
                      00131 
                      00132 
000940                00133 effecttest2:
                      00134 ;       call    ui_main_menu_scan
                      00135 ;       tstfsz  SCRATCH0                        ; user cmd?
                      00136 ;       call    sendcmdbyte                     ; if yes
000940 EFA4 F004      00137         goto    effecttest_doit         ; if yes
                      00138 
000944 EFA0 F004      00139         goto    effecttest2
                      00140 
000948                00141 effecttest_doit:
000948 7082           00142         btg             PORTC, 0
00094A EC16 F019      00143         call    event_pos
                      00144 ;       call    effect_set
00094E EC80 F018      00145         call    fade
000952 EC80 F018      00146         call    fade
000956 EC80 F018      00147         call    fade
00095A EC80 F018      00148         call    fade
00095E EC80 F018      00149         call    fade
000962 EC80 F018      00150         call    fade
000966 EC80 F018      00151         call    fade
00096A EC80 F018      00152         call    fade
00096E EC80 F018      00153         call    fade
                      00154 
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000972 EC2A F019      00155         call    event_neg
000976 EC80 F018      00156         call    fade
00097A EC80 F018      00157         call    fade
00097E EC80 F018      00158         call    fade
000982 EC80 F018      00159         call    fade
000986 EC80 F018      00160         call    fade
00098A EC80 F018      00161         call    fade
00098E EC80 F018      00162         call    fade
000992 EC80 F018      00163         call    fade
000996 EC80 F018      00164         call    fade
                      00165 
                      00166 ;       call    diffuse
                      00167 ;       call    fade
                      00168 ;       movlw   'S'
                      00169 ;       call    SENDCMNDP2
                      00170 ;       call    delaysec
                      00171 
00099A EFA0 F004      00172         goto    effecttest2
                      00173 
                      00174 
                      00175 
00099E                00176 main:
00099E ECC0 F008      00177         call    ui_show_addr
0009A2 ECD2 F007      00178         call    ui_main_menu
                      00179 
0009A6 0E0D           00180         movlw   '\r'                    ; carriage return
0009A8 180C           00181         xorwf   SCRATCH0, w
0009AA E010           00182         bz              intensloop
                      00183 
                      00184 ;       movlw   B'11100000'             ; "all colors off"
                      00185 ;       movwf   COMMAND
                      00186 ;       call    send1wire
                      00187 
0009AC 0E07           00188         movlw   B'00000111'
0009AE 161E           00189         andwf   COLOR
                      00190 
0009B0 501E           00191         movf    COLOR, w
0009B2 EC5D F007      00192         call    SENDBIN
0009B6 EC8C F006      00193         call    SENDCMNDP2CR
                      00194 
0009BA 501D           00195         movf    INTENS, w
0009BC EC5D F007      00196         call    SENDBIN
0009C0 EC8C F006      00197         call    SENDCMNDP2CR
                      00198 
0009C4 ECFD F004      00199         call    sendcmdbyte
                      00200 
0009C8 EFCF F004      00201         goto    main
                      00202 
0009CC                00203 intensloop:
0009CC 0E0A           00204         movlw   H'0A'
0009CE 6E0D           00205         movwf   SCRATCH1
                      00206 ;       clrf    INTENS
0009D0 0E00           00207         movlw   H'00'
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0009D2 6E1D           00208         movwf   INTENS
                      00209 
0009D4                00210 intensloop_up:
0009D4 2A1D           00211         incf    INTENS
0009D6 ECFD F004      00212         call    sendcmdbyte
0009DA 2E0D           00213         decfsz  SCRATCH1
0009DC EFEA F004      00214         goto    intensloop_up
                      00215 
                      00216 ;       call    delay20sec              ; delay to see what happened...
                      00217 ;       comf    ADDR
                      00218 
0009E0                00219 intensloop2:
0009E0 0E0A           00220         movlw   H'0A'
0009E2 6E0D           00221         movwf   SCRATCH1
0009E4                00222 intensloop_dn:
0009E4 061D           00223         decf    INTENS
0009E6 ECFD F004      00224         call    sendcmdbyte
0009EA 2E0D           00225         decfsz  SCRATCH1
0009EC EFF2 F004      00226         goto    intensloop_dn
                      00227 
0009F0                00228 colorchg:
                      00229 ;       call    delay20sec              ; delay to see what happened...
                      00230 ;       call    delaysec
0009F0 EC81 F005      00231         call    delaysec
                      00232 
0009F4 2A1E           00233         incf    COLOR
                      00234 
                      00235 ;       goto    main
0009F6 EFE6 F004      00236         goto    intensloop
                      00237 
                      00238 
0009FA                00239 sendcmdbyte:
                      00240 
0009FA 501E           00241         movf    COLOR, w
0009FC EC5D F007      00242         call    sendbin
000A00 0E20           00243         movlw   ' '
000A02 EC87 F006      00244         call    SENDCMNDP2
000A06 EC87 F006      00245         call    SENDCMNDP2
000A0A 501D           00246         movf    INTENS, w
000A0C EC5D F007      00247         call    sendbin
000A10 0E20           00248         movlw   ' '
000A12 EC87 F006      00249         call    SENDCMNDP2
000A16 EC87 F006      00250         call    SENDCMNDP2
                      00251 
000A1A 501D           00252         movf    INTENS, w
000A1C 0B0F           00253         andlw   B'00001111'
000A1E 6E20           00254         movwf   COMMAND         ; only valid intensities... ; FIXME: CHECKME: kills 'set group address'?
000A20 501E           00255         movf    COLOR, w
000A22 0B07           00256         andlw   B'00000111'     ; only valid colors...
000A24 3AE8           00257         swapf   WREG
                      00258         ;bcf    STATUS, C
                      00259         ;rlcf   WREG
000A26 1220           00260         iorwf   COMMAND
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00261 
                      00262 
                      00263 ;       movlw   B'011110111'
                      00264 ;       movwf   COMMAND
000A28 EC9B F007      00265         call    send1wire
                      00266         ;call   delay_68
                      00267         sendstring      str_sent_cmd
000A2C 0E00               M         movlw   upper   str_sent_cmd
000A2E 6EF8               M         movwf   TBLPTRU
000A30 0E32               M         movlw   high    str_sent_cmd
000A32 6EF7               M         movwf   TBLPTRH
000A34 0EE6               M         movlw   low             str_sent_cmd
000A36 6EF6               M         movwf   TBLPTRL
000A38 EC2C F004          M         call    stringsender
000A3C 501F           00268         movf    ADDR, w
000A3E ECBE F006      00269         call    SENDHEX
000A42 0E20           00270         movlw   ' '
000A44 EC87 F006      00271         call    SENDCMNDP2
000A48 EC87 F006      00272         call    SENDCMNDP2
000A4C 5020           00273         movf    COMMAND, w
000A4E EC5D F007      00274         call    sendbin
000A52 EC8C F006      00275         call    SENDCMNDP2CR
                      00276 ;       call    delaysec
                      00277 
000A56 0012           00278         return
                      00279 
                      00280 
                      00281 
000A58                00282 stop:
000A58 EF2C F005      00283         goto    stop
                      00284 
                      00285 
                      00286 #include        "ports.inc"
                      00001 ; $Id: ports.inc,v 1.2 2005/07/31 21:31:31 tgipson Exp $
000A5C                00002 str_ports:
000A5C 4924 3A64 7020 00003         DW      "$Id: ports.inc,v 1.2 2005/07/31 21:31:31 tgipson Exp $\r\n\x00"
       726F 7374 692E 
       636E 762C 3120 
       322E 3220 3030 
       2F35 3730 332F 
       2031 3132 333A 
       3A31 3133 7420 
       6967 7370 6E6F 
       4520 7078 2420 
       0A0D 0000 
                      00004 
                      00005 
                      00006 
000A96                00007 init_ports:
                      00008 
000A96 0E0E           00009         MOVLW B'00001110' ; Configure A/D
000A98 6EC1           00010         MOVWF ADCON1 ; for digital inputs // except AN0
                      00011 ;       MOVLW 07h ; Configure comparators
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00012 ;       MOVWF CMCON ; for digital input
                      00013 
                      00014 
000A9A 9C94           00015         bcf                     TRISC, 6        ; Tx
000A9C 8E94           00016         bsf                     TRISC, 7        ; Rx
                      00017 
000A9E 9693           00018         bcf                     SDIOTRIS, S_DO
000AA0 9094           00019         bcf                     TRISC, 0        ; LED
                      00020 
000AA2 8093           00021         bsf                     SDIOTRIS, ACCEL_X
000AA4 9293           00022         bcf                     SDIOTRIS, ACCEL_PWR
                      00023 
                      00024 
000AA6 0012           00025         return
                      00287 ;#include       "fakespi.inc"
                      00288 #include        "delay.inc"
                      00001 ; $Id: delay.inc,v 1.2 2005/07/31 21:31:31 tgipson Exp $
                      00002 
                      00003 ; copied from pdasdl01.h 2004/03/17 by Tim Gipson for LCMEMII::HRU
                      00004 ; imdelay.h
                      00005 
000AA8                00006 str_delay_ver:
000AA8 4924 3A64 6420 00007         DW      "$Id: delay.inc,v 1.2 2005/07/31 21:31:31 tgipson Exp $\r\n\x00"
       6C65 7961 692E 
       636E 762C 3120 
       322E 3220 3030 
       2F35 3730 332F 
       2031 3132 333A 
       3A31 3133 7420 
       6967 7370 6E6F 
       4520 7078 2420 
       0A0D 0000 
                      00008 
                      00009 ;------------------------------------------------------------------------
000AE2                00010 delaymsec4M:    ; delay 1 millisecond with 4MHz crystal
000AE2 0E17           00011         movlw   17h
000AE4 6E02           00012         movwf   del3
000AE6                00013 d4m3:
000AE6 0E02           00014         movlw   2h
000AE8 6E03           00015         movwf   del2
000AEA                00016 d4m2:
000AEA 0E06           00017         movlw   6h
000AEC 6E04           00018         movwf   del1
000AEE                00019 d4m1:
000AEE 2E04           00020         decfsz  del1,f
000AF0 EF77 F005      00021         goto    d4m1
                      00022 
000AF4 2E03           00023         decfsz  del2,f
000AF6 EF75 F005      00024         goto    d4m2
                      00025 
000AFA 2E02           00026         decfsz  del3,f
000AFC EF73 F005      00027         goto    d4m3
                      00028 
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000B00 0C00           00029         retlw   0
                      00030 
                      00031 ;------------------------------------------------------------------------
                      00032 
000B02                00033 delaysec:       ; delay 1 second with 4MHz crystal
000B02 0E02           00034         movlw   02h             ;17h
000B04 6E02           00035         movwf   del3
000B06                00036 d3:
000B06 0E80           00037         movlw   80h
000B08 6E03           00038         movwf   del2
000B0A                00039 d2:
000B0A 0E70           00040         movlw   70h
000B0C 6E04           00041         movwf   del1
000B0E                00042 d1:
000B0E 2E04           00043         decfsz  del1,f
000B10 EF87 F005      00044         goto    d1
                      00045 
000B14 2E03           00046         decfsz  del2,f
000B16 EF85 F005      00047         goto    d2
                      00048 
000B1A 2E02           00049         decfsz  del3,f
000B1C EF83 F005      00050         goto    d3
                      00051 
000B20 0C00           00052         retlw   0
                      00053 
                      00054 ;------------------------------------------------------------------------
000B22                00055 delay20k:       ; delay for 20 kHz with 8MHz crystal
000B22 0E03           00056         movlw   03h
000B24 6E03           00057         movwf   del2
000B26                00058 d2m2:
000B26 0E08           00059         movlw   8h
000B28 6E04           00060         movwf   del1
000B2A                00061 d2m1:
000B2A 2E04           00062         decfsz  del1,f
000B2C EF95 F005      00063         goto    d2m1
                      00064 
000B30 2E03           00065         decfsz  del2,f
000B32 EF93 F005      00066         goto    d2m2
                      00067 
000B36 0C00           00068         retlw   0
                      00069 
                      00070 
                      00071 ;------------------------------------------------------------------------
000B38                00072 delaymsec:      ; delay 1 millisecond with 10MHz crystal
000B38 0E05           00073         movlw   05h
000B3A 6E02           00074         movwf   del3
000B3C                00075 dm3:
000B3C 0E13           00076         movlw   13h
000B3E 6E03           00077         movwf   del2
000B40                00078 dm2:
000B40 0E08           00079         movlw   8h
000B42 6E04           00080         movwf   del1
000B44                00081 dm1:
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000B44 2E04           00082         decfsz  del1,f
000B46 EFA2 F005      00083         goto    dm1
                      00084 
000B4A 2E03           00085         decfsz  del2,f
000B4C EFA0 F005      00086         goto    dm2
                      00087 
000B50 2E02           00088         decfsz  del3,f
000B52 EF9E F005      00089         goto    dm3
                      00090 
000B56 0C00           00091         retlw   0
                      00092 
                      00093 ;at 0.4 instruction per uSec, 1mSec needs 2500 instructions
                      00094 ;done with any of the following values: time = a3 * (6 + (a2 * (6 + (a1 * 4))))
                      00095 ;a3 = 1 a2 = 14 a1 = 43.
                      00096 ;a3 = 1 a2 = 29 a1 = 20.
                      00097 ;a3 = 1 a2 = 43 a1 = 13.
                      00098 ;a3 = 1 a2 = 178 a1 = 2.
                      00099 ;a3 = 2 a2 = 2 a1 = 154.
                      00100 ;a3 = 5 a2 = 1 a1 = 122.
                      00101 ;a3 = 5 a2 = 13 a1 = 8.
                      00102 ;a3 = 5 a2 = 19 a1 = 5.
                      00103 ;a3 = 10 a2 = 2 a1 = 29.
                      00104 ;a3 = 25 a2 = 1 a1 = 22.
                      00105 ;a3 = 50 a2 = 2 a1 = 4.
                      00106 ;a3 = 125 a2 = 1 a1 = 2.
                      00107 ;------------------------------------------------------------------------
                      00108 
000B58                00109 delayhmsec:     ; delay 1/2 millisecond with 10MHz crystal
000B58 0E05           00110         movlw   05h
000B5A 6E02           00111         movwf   del3
000B5C                00112 dhm3:
000B5C 0E13           00113         movlw   13h
000B5E 6E03           00114         movwf   del2
000B60                00115 dhm2:
000B60 0E04           00116         movlw   4h
000B62 6E04           00117         movwf   del1
000B64                00118 dhm1:
000B64 2E04           00119         decfsz  del1,f
000B66 EFB2 F005      00120         goto    dhm1
                      00121 
000B6A 2E03           00122         decfsz  del2,f
000B6C EFB0 F005      00123         goto    dhm2
                      00124 
000B70 2E02           00125         decfsz  del3,f
000B72 EFAE F005      00126         goto    dhm3
                      00127 
000B76 0C00           00128         retlw   0
                      00129 
                      00130 ;------------------------------------------------------------------------
                      00131 
000B78                00132 delaysome:      ; delay x usecond with 10MHz crystal
000B78 0E04           00133         movlw   04h
000B7A 6E02           00134         movwf   del3
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000B7C                00135 ds3:
000B7C 0E05           00136         movlw   5h
000B7E 6E03           00137         movwf   del2
000B80                00138 ds2:
000B80 0E04           00139         movlw   4h
000B82 6E04           00140         movwf   del1
000B84                00141 ds1:
000B84 2E04           00142         decfsz  del1,f
000B86 EFC2 F005      00143         goto    ds1
                      00144 
000B8A 2E03           00145         decfsz  del2,f
000B8C EFC0 F005      00146         goto    ds2
                      00147 
000B90 2E02           00148         decfsz  del3,f
000B92 EFBE F005      00149         goto    ds3
                      00150 
000B96 0C00           00151         retlw   0
                      00152 ;------------------------------------------------------------------------
                      00153 
000B98                00154 delayhsome:     ; delay 1/2 x usecond with 10MHz crystal
000B98 0E04           00155         movlw   04h
000B9A 6E02           00156         movwf   del3
000B9C                00157 dhs3:
000B9C 0E05           00158         movlw   5h
000B9E 6E03           00159         movwf   del2
000BA0                00160 dhs2:
000BA0 0E02           00161         movlw   2h
000BA2 6E04           00162         movwf   del1
000BA4                00163 dhs1:
000BA4 2E04           00164         decfsz  del1,f
000BA6 EFD2 F005      00165         goto    dhs1
                      00166 
000BAA 2E03           00167         decfsz  del2,f
000BAC EFD0 F005      00168         goto    dhs2
                      00169 
000BB0 2E02           00170         decfsz  del3,f
000BB2 EFCE F005      00171         goto    dhs3
                      00172 
000BB6 0C00           00173         retlw   0
                      00174 
                      00175 ;----------------------------------
000BB8                00176 delay20msec:
000BB8 EC9C F005      00177         call    delaymsec
000BBC EC9C F005      00178         call    delaymsec
000BC0 EC9C F005      00179         call    delaymsec
000BC4 EC9C F005      00180         call    delaymsec
000BC8 EC9C F005      00181         call    delaymsec
000BCC EC9C F005      00182         call    delaymsec
000BD0 EC9C F005      00183         call    delaymsec
000BD4 EC9C F005      00184         call    delaymsec
000BD8 EC9C F005      00185         call    delaymsec
000BDC EC9C F005      00186         call    delaymsec
000BE0 EC9C F005      00187         call    delaymsec
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000BE4 EC9C F005      00188         call    delaymsec
000BE8 EC9C F005      00189         call    delaymsec
000BEC EC9C F005      00190         call    delaymsec
000BF0 EC9C F005      00191         call    delaymsec
000BF4 EC9C F005      00192         call    delaymsec
000BF8 EC9C F005      00193         call    delaymsec
000BFC EC9C F005      00194         call    delaymsec
000C00 EC9C F005      00195         call    delaymsec
000C04 0012           00196         return
                      00197 
                      00198 ;----------------------------------
000C06                00199 delay20sec:
000C06 EC81 F005      00200         call    delaysec
000C0A EC81 F005      00201         call    delaysec
000C0E EC81 F005      00202         call    delaysec
000C12 EC81 F005      00203         call    delaysec
000C16 EC81 F005      00204         call    delaysec
000C1A EC81 F005      00205         call    delaysec
000C1E EC81 F005      00206         call    delaysec
000C22 EC81 F005      00207         call    delaysec
000C26 EC81 F005      00208         call    delaysec
000C2A EC81 F005      00209         call    delaysec
000C2E EC81 F005      00210         call    delaysec
000C32 EC81 F005      00211         call    delaysec
000C36 EC81 F005      00212         call    delaysec
000C3A EC81 F005      00213         call    delaysec
000C3E EC81 F005      00214         call    delaysec
000C42 EC81 F005      00215         call    delaysec
000C46 EC81 F005      00216         call    delaysec
000C4A EC81 F005      00217         call    delaysec
000C4E EC81 F005      00218         call    delaysec
000C52 EC81 F005      00219         call    delaysec
000C56 0012           00220         return
                      00221 
                      00222 
                      00223 
000C58                00224 delaybit:
000C58 6A05           00225         clrf WAITER
                      00226         ;movlw  H'01'
                      00227         ;movwf  WAITER
000C5A                00228 delayb1:        
000C5A 2E05           00229         decfsz  WAITER
000C5C EF2D F006      00230         goto    delayb1
                      00231 
000C60 0012           00232         return
                      00233 
000C62                00234 delay_40:
000C62                00235 delayhalfbit:
000C62 0E40           00236         movlw   H'40'   ;80
000C64 6E05           00237         movwf   WAITER
                      00238 
000C66                00239 delay40_1:      
000C66 2E05           00240         decfsz  WAITER
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000C68 EF33 F006      00241         goto    delay40_1
000C6C 0012           00242         return
                      00243 
                      00244 
000C6E                00245 delay_20:
                      00246 ;delayqbit:
000C6E 0E20           00247         movlw   H'20'   ;40
000C70 6E05           00248         movwf   WAITER
                      00249 
000C72                00250 delay20_1:      
000C72 2E05           00251         decfsz  WAITER
000C74 EF39 F006      00252         goto    delay20_1
000C78 0012           00253         return
                      00254 
000C7A                00255 delay_10:
                      00256 ;delayqbit:
000C7A 0E10           00257         movlw   H'10'   ;40
000C7C 6E05           00258         movwf   WAITER
                      00259 
000C7E                00260 delay10_1:      
000C7E 2E05           00261         decfsz  WAITER
000C80 EF39 F006      00262         goto    delay20_1
000C84 0012           00263         return
                      00264 
                      00265 
000C86                00266 delay_8:
                      00267 ;delayqbit:
000C86 0E08           00268         movlw   H'08'   ;40
000C88 6E05           00269         movwf   WAITER
                      00270 
000C8A                00271 delay8_1:       
000C8A 2E05           00272         decfsz  WAITER
000C8C EF39 F006      00273         goto    delay20_1
000C90 0012           00274         return
                      00275 
                      00276 
                      00277 
000C92                00278 delay_68:
                      00279 ;delayqbit:
000C92 0E44           00280         movlw   D'68'
000C94 6E05           00281         movwf   WAITER
                      00282 
000C96                00283 delay68_1:      
000C96 2E05           00284         decfsz  WAITER
000C98 EF4B F006      00285         goto    delay68_1
000C9C 0012           00286         return
                      00287 
                      00288 
                      00289 
                      00290 
000C9E                00291 delaybit_wusb:
                      00292 ;       return
                      00293 
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00294 ;       ;clrf WAITER
000C9E 0E01           00295         movlw   H'01'
000CA0 6E05           00296         movwf   WAITER
000CA2                00297 delayb1_wusb:   
000CA2 2E05           00298         decfsz  WAITER
000CA4 EF51 F006      00299         goto    delayb1_wusb
                      00300 
000CA8 0012           00301         return
                      00289 #include        "4220uart.inc"
                      00001 ; $Id: 4220uart.inc,v 1.1 2005/07/29 14:58:52 tgipson Exp $
000CAA                00002 str_uart_ver:
000CAA 4924 3A64 3420 00003         DW      "$Id: 4220uart.inc,v 1.1 2005/07/29 14:58:52 tgipson Exp $\r\n\x00"
       3232 7530 7261 
       2E74 6E69 2C63 
       2076 2E31 2031 
       3032 3530 302F 
       2F37 3932 3120 
       3A34 3835 353A 
       2032 6774 7069 
       6F73 206E 7845 
       2070 0D24 000A 
                      00004 
                      00005 
                      00006 ; Drop-in SPI routines for PIC18F4220
                      00007 
                      00008 
                      00009 
000CE6                00010 INITUSART:
                      00011 
000CE6 9EAB           00012         BCF     RCSTA,SPEN      ; Serial port disable
000CE8 9AAB           00013         BCF     RCSTA,SREN      ; Disable single reception
000CEA 98AB           00014         BCF     RCSTA,CREN      ; Disable continious reception
                      00015 
                      00016 
000CEC 8E94           00017         bsf             TRISC, 7        ; RC7 input (Rx)
000CEE 9C94           00018         bcf             TRISC, 6        ; RC6 (Tx)
                      00019 
                      00020 
                      00021 ;--------------- 115,200 bps @ 48MHz
                      00022 ;       movlw   D'00'
                      00023 ;       movwf   SPBRGH
                      00024 ;       movlw   D'25'
                      00025 ;       movwf   SPBRG
                      00026 ;
                      00027 ;       bsf             BAUDCON, BRG16          ; enable 16-bit BRG
                      00028 ;       bcf             TXSTA, BRGH                     ; disable hi-speed baud clock
                      00029 ;---------------
                      00030 
                      00031 
                      00032 ;--------------- 115,200 bps @ 8MHz
000CF0 0E00           00033         movlw   D'00'
000CF2 6EB0           00034         movwf   SPBRGH
000CF4 0E10           00035         movlw   D'16'
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000CF6 6EAF           00036         movwf   SPBRG
                      00037 
000CF8 86B8           00038         bsf             BAUDCON, BRG16          ; enable 16-bit BRG
000CFA 84AC           00039         bsf             TXSTA, BRGH                     ; enable hi-speed baud clock
                      00040 ;---------------
                      00041 
                      00042 
                      00043 
                      00044         ;MOVWF  SPBRG           ; Initialise baud rate generator
                      00045 ;       movff   BAUD, SPBRG     ; Initialize baud rate generator with already-defined rate
                      00046 
                      00047 
                      00048         ;bsf            TXSTA, BRGH                                             ; Enable hi-speed baud c
                            lock
000CFC 8EAC           00049         BSF     TXSTA,CSRC      ; Master mode, clk from BRG
000CFE 9CAC           00050         BCF     TXSTA,TX9       ; Select 8 bit tansmission
000D00 9AAC           00051         BCF     TXSTA,TXEN      ; Transmission disabled
000D02 98AC           00052         BCF     TXSTA,SYNC      ; Asynchronous mode
                      00053 
000D04 9CAB           00054         BCF     RCSTA,RX9       ; Select 8 bit reception
                      00055 
000D06 8EAB           00056         BSF     RCSTA,SPEN      ; Serial port enable
000D08 8AAC           00057         BSF     TXSTA,TXEN      ; Enable transmission
                      00058         ;BCF    PIE1,RC1IE
000D0A 88AB           00059         BSF     RCSTA,CREN      ; Enable reception
                      00060 
                      00061 
000D0C 0012           00062         return
                      00063 
                      00064 ; ---------------------------------------------
000D0E                00065 SENDCMNDP2:
000D0E                00066 SENDCMD:                        ; Send Wreg contents to USART
                      00067 
000D0E A2AC           00068         BTFSS   TXSTA,TRMT      ; Wait until transmitter ready to send next byte
000D10 EF87 F006      00069         GOTO    SENDCMD
000D14 6EAD           00070         MOVWF   TXREG           ; Transfer next byte from WREG to 
                      00071                         ; transmitter register
000D16 0012           00072         RETURN
                      00073 
                      00074 
000D18                00075 SENDCMNDP2CR:
000D18 0E0D           00076         movlw   '\r'
000D1A EC87 F006      00077         call    SENDCMD
000D1E 0E0A           00078         movlw   '\n'
000D20 EC87 F006      00079         call    SENDCMD
000D24 0012           00080         return
                      00081 
                      00082 ; ---------------------------------------------
000D26                00083 getcmd:
000D26                00084 GETCMD:
000D26 AA9E           00085         btfss   PIR1, RCIF                                      ; byte received on USART?
000D28 EF93 F006      00086         goto    GETCMD                                          ; if no
000D2C 50AE           00087         movf    RCREG,0                                         ; if yes - to W
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00088         ;movwf  BYTE                                            ; store it here
000D2E 0012           00089         return
                      00090 
                      00091 
                      00092 ; ---------------------------------------------
                      00093 ; Return 0xFF if byte received, else 0x00
000D30                00094 iscmd:
000D30                00095 ISCMD:
000D30 AA9E           00096         btfss   PIR1, RCIF
000D32 0C00           00097         retlw   H'00'
000D34 50AE           00098         movf    RCREG, 0
000D36 0CFF           00099         retlw   H'FF'
                      00100 
                      00101 ; ---------------------------------------------
                      00102 
000D38                00103 SCANCMD:
000D38 AA9E           00104         btfss   PIR1, RCIF
000D3A 0C00           00105         retlw   H'00'
000D3C 50AE           00106         movf    RCREG, 0
000D3E 0012           00107         return
                      00290 #include        "lcmhex01.inc"
                      00001 ; $Id: lcmhex01.inc,v 1.1 2005/07/29 14:58:52 tgipson Exp $
000D40                00002 str_hex_ver:
000D40 4924 3A64 6C20 00003         DW      "$Id: lcmhex01.inc,v 1.1 2005/07/29 14:58:52 tgipson Exp $\r\n\x00"
       6D63 6568 3078 
       2E31 6E69 2C63 
       2076 2E31 2031 
       3032 3530 302F 
       2F37 3932 3120 
       3A34 3835 353A 
       2032 6774 7069 
       6F73 206E 7845 
       2070 0D24 000A 
                      00004 
                      00005 
                      00006 ; copied to lcmhex01.h for pic18f6620
                      00007 ; 2004/01/26 by Tim Gipson for LCMEM::SDR
                      00008 ; bank switching removed
                      00009 
                      00010 ; imhex01.h for pic16f874
                      00011 ; 11/02/2001 Gert Muller for IMEMS
                      00012 ; no change
                      00013 
                      00014 ; sdhex01.h for pic16f873
                      00015 ; 5/4/2001 Gert Muller for SDBS
                      00016 
                      00017 ; h01hex.h for pic17c
                      00018 ; recieving values in ASCII as two characters and convert to one byte  10/17/2000 - Gert Muller
                      00019 ; sending values in wreg as two hexadecimal digits  7/31/2000 - Gert Muller
                      00020 
000D7C                00021 SENDHEX:
                      00022         ;BCF    STATUS, RP0
000D7C 6E08           00023         MOVWF   HEXTEMP
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000D7E 0EF0           00024         MOVLW   B'11110000'
000D80 1408           00025         ANDWF   HEXTEMP,W
000D82 6E09           00026         MOVWF   HEXTEMP1
000D84 3809           00027         SWAPF   HEXTEMP1,W
000D86 ECCA F006      00028         CALL    SENDNIB
                      00029 
000D8A 0E0F           00030         MOVLW   B'00001111'
000D8C 1408           00031         ANDWF   HEXTEMP,W
000D8E ECCA F006      00032         CALL    SENDNIB
                      00033 
000D92 0012           00034         RETURN
                      00035 
                      00036 ;------------------------------------------------------------------
                      00037 
000D94                00038 SENDNIB:
000D94 6E09           00039         MOVWF   HEXTEMP1
000D96 0809           00040         SUBLW   H'09'
000D98 B0D8           00041         BTFSC   STATUS,C
000D9A EFD6 F006      00042         GOTO    SENDHEXNUM
000D9E EFD1 F006      00043         GOTO    SENDHEXALPHA
000DA2                00044 SENDHEXALPHA:
000DA2 0E37           00045         MOVLW   H'37'
000DA4 2409           00046         ADDWF   HEXTEMP1,W      
000DA6 EC87 F006      00047         CALL    SENDCMNDP2
000DAA 0012           00048         RETURN
000DAC                00049 SENDHEXNUM:
000DAC 0E30           00050         MOVLW   H'30'
000DAE 2409           00051         ADDWF   HEXTEMP1,W      
000DB0 EC87 F006      00052         CALL    SENDCMNDP2
000DB4 0012           00053         RETURN
                      00054 
                      00055 ;-----------------------------------------------------------------
                      00056 
000DB6                00057 ASCII2HEX:                      ; converts SERR01 and SERR02 to HEXCONV
                      00058         ;BCF    STATUS,RP0      ; bank 0
000DB6 500A           00059         MOVF    SERR01,W
000DB8 6E06           00060         MOVWF   HEXCONV
000DBA 0840           00061         SUBLW   H'40'
000DBC B0D8           00062         BTFSC   STATUS,C
000DBE EFE8 F006      00063         GOTO    ASCDIGIT1
000DC2 EFE3 F006      00064         GOTO    ASCALPHA1
000DC6                00065 ASCALPHA1:
000DC6 0E37           00066         MOVLW   H'37'
000DC8 5E06           00067         SUBWF   HEXCONV,F
000DCA 3A06           00068         SWAPF   HEXCONV,F
000DCC EFED F006      00069         GOTO    NEXTNIB
000DD0                00070 ASCDIGIT1:
000DD0 0E30           00071         MOVLW   H'30'
000DD2 5E06           00072         SUBWF   HEXCONV,F
000DD4 3A06           00073         SWAPF   HEXCONV,F
000DD6 EFED F006      00074         GOTO    NEXTNIB
000DDA                00075 NEXTNIB:
000DDA 5006           00076         MOVF    HEXCONV,W
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00077 ;       CALL    SENDHEX
000DDC 0E00           00078         MOVLW   H'00'
                      00079 ;       CALL    SENDHEX
                      00080 
                      00081         ;BCF    STATUS, RP0
000DDE 500B           00082         MOVF    SERR02,W
000DE0 6E07           00083         MOVWF   HEXCONV1
000DE2 0840           00084         SUBLW   H'40'
000DE4 B0D8           00085         BTFSC   STATUS,W
000DE6 EFFD F006      00086         GOTO    ASCDIGIT2
000DEA EFF7 F006      00087         GOTO    ASCALPHA2       
000DEE                00088 ASCALPHA2:
000DEE 0E37           00089         MOVLW   H'37'
000DF0 5E07           00090         SUBWF   HEXCONV1,F
000DF2 5007           00091         MOVF    HEXCONV1,W
000DF4 2606           00092         ADDWF   HEXCONV,F
000DF6 EF03 F007      00093         GOTO    DONENIB
000DFA                00094 ASCDIGIT2:
000DFA 0E30           00095         MOVLW   H'30'
000DFC 5E07           00096         SUBWF   HEXCONV1,F
000DFE 5007           00097         MOVF    HEXCONV1,W
000E00 2606           00098         ADDWF   HEXCONV,F
000E02 EF03 F007      00099         GOTO    DONENIB
000E06                00100 DONENIB:
000E06 5007           00101         MOVF    HEXCONV1,W
                      00102 ;
000E08 ECBE F006      00103         CALL    SENDHEX
                      00104         ;BCF    STATUS,RP0      ; BANK 0
000E0C 5006           00105         MOVF    HEXCONV,W
000E0E 0012           00106         RETURN
                      00107 
                      00291 #include        "defs.inc"
                      00001 ; $Id: defs.inc,v 1.2 2005/07/31 21:31:31 tgipson Exp $
                      00002 
                      00003 ; Port and bit definitions
                      00004 
                      00005 ; FakeSDI serial
  00000F81            00006 SDIO            equ     PORTB
  00000F93            00007 SDIOTRIS        equ     TRISB
  00000001            00008 ACCEL_PWR       equ     1
  00000003            00009 S_DO            equ     3                       ; NOTE: SD_I / SD_O defined here relative to PIC, not AD
                            C!
  00000000            00010 ACCEL_X         equ     0
                      00011 ;ACCEL_Y                equ     2
                      00012 
                      00013 
000E10                00014 str_defs_ver:
000E10 4924 3A64 6420 00015         DW      "$Id: defs.inc,v 1.2 2005/07/31 21:31:31 tgipson Exp $\r\n\x00"
       6665 2E73 6E69 
       2C63 2076 2E31 
       2032 3032 3530 
       302F 2F37 3133 
       3220 3A31 3133 
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       333A 2031 6774 
       7069 6F73 206E 
       7845 2070 0D24 
       000A 
                      00292 #include        "vars.inc"
                      00001 ; $Id: vars.inc,v 1.2 2005/07/31 21:31:31 tgipson Exp $
000E48                00002 str_vars_ver:
000E48 4924 3A64 7620 00003         DW      "$Id: vars.inc,v 1.2 2005/07/31 21:31:31 tgipson Exp $"
       7261 2E73 6E69 
       2C63 2076 2E31 
       2032 3032 3530 
       302F 2F37 3133 
       3220 3A31 3133 
       333A 2031 6774 
       7069 6F73 206E 
       7845 2070 0024 
                      00004 
                      00005 
                      00006 ; Variable (RAM) allocation
                      00007 
                      00008 ; ------------------------------
                      00009 
                      00010         cblock 0
                      00011 
                      00012         ; for fake SPI
  00000000            00013                 RWDATA
  00000001            00014                 ROTATE
                      00015 
                      00016         ; for delay functions
  00000002            00017                 del3
  00000003            00018                 del2
  00000004            00019                 del1
                      00020                 ;waiter
  00000005            00021                 WAITER
                      00022 
                      00023         ; for hex conv.
  00000006            00024                 HEXCONV
  00000007            00025                 HEXCONV1
  00000008            00026                 HEXTEMP
  00000009            00027                 HEXTEMP1
  0000000A            00028                 SERR01
  0000000B            00029                 SERR02
                      00030 
                      00031         ; scratch
  0000000C            00032                 SCRATCH0
  0000000D            00033                 SCRATCH1
  0000000E            00034                 SCRATCH2
  0000000F            00035                 SCRATCH3
  00000010            00036                 SCRATCH4
  00000011            00037                 SCRATCH5
  00000012            00038                 SCRATCH6
  00000013            00039                 SCRATCH7
                      00040 
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00041         ; ADC result
  00000014            00042                 ADC3
  00000015            00043                 ADC2
  00000016            00044                 ADC1
  00000017            00045                 ADC0
                      00046                 ;RES_CHANNEL            ; channel the result read was from. (DEBUG)
                      00047 
                      00048 
                      00049         ; for ADC stuff
                      00050 ;               CHANNEL         ; current ADC channel
                      00051 ;               MUXCH           ; current mux channel
                      00052 ;               NCHAN           ; number of channels of interest
                      00053 ;               USER_NAVG       ; user-specified number of averages
                      00054 
  00000018            00055                 ANALOGH
  00000019            00056                 ANALOGL
                      00057 
                      00058         ; for EEPROM
  0000001A            00059                 EEADDRH
  0000001B            00060                 EEADDRL
  0000001C            00061                 ROLLOVER
                      00062 
                      00063         ; blinky
  0000001D            00064                 INTENS
  0000001E            00065                 COLOR
  0000001F            00066                 ADDR
  00000020            00067                 COMMAND
                      00068 
  00000021            00069                 INTENS_R
  00000022            00070                 INTENS_G
  00000023            00071                 INTENS_B
                      00072 
                      00073         ; table
                      00074         endc
                      00075 
                      00076         cblock  0x100
  00000100            00077                 ADDRTBL         ; Must be last entry!...
                      00078         endc
                      00079 
                      00293 #include        "sendbin.inc"
                      00001 ; $Id: sendbin.inc,v 1.1 2005/07/29 14:58:52 tgipson Exp $
000E7E                00002 str_sendbin_ver:
000E7E 4924 3A64 7320 00003         DW      "$Id: sendbin.inc,v 1.1 2005/07/29 14:58:52 tgipson Exp $\r\n\x00"
       6E65 6264 6E69 
       692E 636E 762C 
       3120 312E 3220 
       3030 2F35 3730 
       322F 2039 3431 
       353A 3A38 3235 
       7420 6967 7370 
       6E6F 4520 7078 
       2420 0A0D 0000 
                      00004 
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00005 
                      00006 ; Binary counterpart to SENDHEX in (lcmhex01.inc)
                      00007 
000EBA                00008 sendbin:
000EBA                00009 SENDBIN:
000EBA 6E0C           00010         movwf   SCRATCH0                                ; or any temporary variable
                      00011 
000EBC 0E08           00012         movlw   H'08'
000EBE 6E01           00013         movwf   ROTATE                                  ; just another scratch variable
                      00014 
000EC0                00015 sendbin1:
000EC0 0E30           00016         movlw   '0'
000EC2 BE0C           00017         btfsc   SCRATCH0, 7
000EC4 0E31           00018         movlw   '1'
000EC6 EC87 F006      00019         call    SENDCMNDP2
                      00020 
000ECA 460C           00021         rlncf   SCRATCH0                                ; test next bit...
000ECC 2E01           00022         decfsz  ROTATE
000ECE EF60 F007      00023         goto    sendbin1
                      00024 
000ED2 0012           00025         return
                      00294 #include        "4220anlg.inc"
                      00001 ; $Id: 4220anlg.inc,v 1.1 2005/02/08 22:02:10 tgipson Exp $
                      00002 
                      00003 ; Stolen from lcmansen.inc 2005/02/07 by Tim Gipson for ACONDv2
                      00004 ; lcmansen.inc created 2004/01/29 by Tim Gipson for LCMEM::SDR
                      00005 ; PIC18F4220 (and others?) ADC channel read functions
                      00006 
                      00007 
                      00008 ;------------------------------------------------------------------------
                      00009 ; Reads analog channel stored in WREG (read_int_ADC_chan).
                      00010 ;       or
                      00011 ; Reads currently selected channel (read_int_ADC).
                      00012 ; Result returned in ANALOGH:ANALOGL
                      00013 
000ED4                00014 read_int_ADC_chan:
000ED4 EC75 F007      00015         call    set_int_ADC_chan
                      00016 
000ED8                00017 read_int_ADC:
000ED8 82C2           00018         bsf             ADCON0, 1                                       ; start conversion
                      00019 
000EDA                00020 read_int_ADC_wait:
000EDA B2C2           00021         btfsc   ADCON0, 1                                       ; conversion finished?
000EDC EF6D F007      00022         goto    read_int_ADC_wait                       ; if no
                      00023 
000EE0 50C4           00024         movf    ADRESH,w
000EE2 6E18           00025         movwf   ANALOGH
                      00026         ;call   SENDHEX
000EE4 50C3           00027         movf    ADRESL,w
000EE6 6E19           00028         movwf   ANALOGL
                      00029         ;call   SENDHEX
                      00030         ;call   SENDCMNDP2CR
000EE8 0012           00031         return
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00032 
                      00033 
                      00034 ; -------------------------------------------------------------------------
                      00035 ; Write the analog channel # in WREG to ADCON0 (shifted per ADCON0 requirements), and turn A/D module on
                      00036 
000EEA                00037 set_int_ADC_chan:
000EEA 90D8           00038         bcf             STATUS, C               ; shift channel # left 2
000EEC 32E8           00039         rrcf    WREG                    ; ...
000EEE 90D8           00040         bcf             STATUS, C               ;
000EF0 32E8           00041         rrcf    WREG                    ;
000EF2 80E8           00042         bsf             WREG, 0                 ; will turn A/D module on
000EF4 6EC2           00043         movwf   ADCON0
000EF6 0012           00044         return
                      00045 
                      00046 ; -------------------------------------------------------------------------
                      00047 ; Setup justification and acq. time
                      00048 
000EF8                00049 init_int_ADC:
000EF8 0EBE           00050         movlw   B'10111110'             ; Right justified, acquisition time 20AD (slowest), conversion c
                            lock Fosc/64 (slowest)
000EFA 6EC0           00051         movwf   ADCON2
000EFC 0012           00052         return
                      00295 ;#include       "bri_math.inc"  ; average
                      00296 ;#include       "ltc2418.inc"
                      00297 ;#include       "node.inc"
                      00298 ;#include       "ui.inc"
                      00299 ;#include       "eeprom.inc"
                      00300 ;#include       "test.inc"
                      00301 #include        "debug.inc"
                      00001 
                      00002 
                      00003 
                      00004 
                      00005 
000EFE                00006 showfsr:
000EFE 50EA           00007         movf    FSR0H, w
000F00 ECBE F006      00008         call    SENDHEX
000F04 50E9           00009         movf    FSR0L, w
000F06 ECBE F006      00010         call    SENDHEX
000F0A 0E20           00011         movlw   ' '
000F0C EC87 F006      00012         call    SENDCMNDP2
000F10 50E2           00013         movf    FSR1H, w
000F12 ECBE F006      00014         call    SENDHEX
000F16 50E1           00015         movf    FSR1L, w
000F18 ECBE F006      00016         call    SENDHEX
000F1C 0E20           00017         movlw   ' '
000F1E EC87 F006      00018         call    SENDCMNDP2
000F22 50DA           00019         movf    FSR2H, w
000F24 ECBE F006      00020         call    SENDHEX
000F28 50D9           00021         movf    FSR2L, w
000F2A ECBE F006      00022         call    SENDHEX
000F2E EC8C F006      00023         call    SENDCMNDP2CR
000F32 0012           00024         return
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00025 
                      00026 
000F34                00027 mathtest:
                      00028 ;       movlw   
                      00029 
                      00030 
000F34 0012           00031         return
                      00302 #include        "onewire.inc"
                      00001 ; $Id: $
                      00002 
                      00003 
                      00004 ; Routines for 1-wire write-only interface.
                      00005 
                      00006 ; -------------------------------------------------
                      00007 ; Send byte in WREG on 1-wire interface
                      00008 ; Assumes master clock running at 2x of slave clock
                      00009 
                      00010 #define         delay_one       delay_40
                      00011 #define         delay_zero      delay_20
                      00012 ;#define                delay_dt        delaybit
                      00013 
                      00014 #define         delay_dt        delay_68
                      00015 
000F36                00016 send1wire:
                      00017         ;call   delaysec        
                      00018         ;call   delay_dt
000F36 EC2C F006      00019         call    delaybit
                      00020 
000F3A ECCB F007      00021         call    send1wire_start
000F3E 501F           00022         movf    ADDR, w
000F40 ECA6 F007      00023         call    send1wire_byte
000F44 5020           00024         movf    COMMAND, w
000F46 ECA6 F007      00025         call    send1wire_byte
                      00026 
                      00027 ;       call    delaybit                ; long delay forced for WDT resets
                      00028 ;       call    delaybit
                      00029 ;       call    delaybit
                      00030 ;       call    delaybit
                      00031 ;       call    delaybit
                      00032 ;       call    delaybit
                      00033 ;       call    delaybit
                      00034 ;       call    delaybit
                      00035 ;       call    delaybit                ; long delay forced for WDT resets
                      00036 ;       call    delaybit
                      00037 ;       call    delaybit
                      00038 ;       call    delaybit
                      00039 ;       call    delaybit
                      00040 ;       call    delaybit
                      00041 ;       call    delaybit
                      00042 ;       call    delaybit
000F4A 0012           00043         return
                      00044 
                      00045 
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00046 ; -------------------------------
                      00047 
                      00048 ;send1wire_byte:
                      00049 ;       movwf   RWDATA
                      00050 ;       movlw   H'08'
                      00051 ;       movwf   ROTATE
                      00052 ;
                      00053 ;send1wire2:
                      00054 ;       bsf             SDIO, S_DO              ; Start next bit
                      00055 ;       call    delay_zero              ; delay for '0' bit
                      00056 ;       rlcf    RWDATA                  ; shift leftmost bit into carry
                      00057 ;       btfsc   STATUS, C               ; is 1?
                      00058 ;       call    delay_one               ; if yes - delay longer for '1' bit
                      00059 ;       bcf             SDIO, S_DO              ; end bit
                      00060 ;;      call    delayhalfbit    ; ...
                      00061 ;
                      00062 ;;      call    delay_dt                ; long delay for extra PWM
                      00063 ;       call    delay_zero
                      00064 ;
                      00065 ;       decfsz  ROTATE
                      00066 ;       goto    send1wire2
                      00067 ;
                      00068 ;
                      00069 ;;      bcf             SDIO, S_DO
                      00070 ;;      call    delaybit
                      00071 ;       return
                      00072 ;
                      00073 ; zero: short low, long high
                      00074 ; one: long low, short high
                      00075 
000F4C                00076 send1wire_byte:
000F4C 6E00           00077         movwf   RWDATA
000F4E 0E08           00078         movlw   H'08'
000F50 6E01           00079         movwf   ROTATE
                      00080 
000F52                00081 send1wire2:
000F52 3600           00082         rlcf    RWDATA                  ; shift leftmost bit into carry
000F54 A0D8           00083         btfss   STATUS, C               ; is it 0?
000F56 EFBA F007      00084         goto    send1wire_zero  ; if yes
000F5A                00085 send1wire_one:
000F5A 9681           00086         bcf             SDIO, S_DO              ; low: first half of bit
000F5C EC3D F006      00087         call    delay_10
                      00088         ;call   delay_8
000F60 EC3D F006      00089         call    delay_10
                      00090         ;call   delay_10
                      00091 
000F64 8681           00092         bsf             SDIO, S_DO              ; high: 2nd half of bit
000F66 EC43 F006      00093         call    delay_8
000F6A 9681           00094         bcf             SDIO, S_DO              ; end bit
                      00095 
000F6C 2E01           00096         decfsz  ROTATE                  ; done byte?
000F6E EFA9 F007      00097         goto    send1wire2              ; if no - next window please
000F72 0012           00098         return                                  ; if yes
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00099 
000F74                00100 send1wire_zero:
000F74 9681           00101         bcf             SDIO, S_DO              ; low: first half of bit
000F76 EC3D F006      00102         call    delay_10
000F7A EC3D F006      00103         call    delay_10
                      00104         ;call   delay_8
000F7E 8681           00105         bsf             SDIO, S_DO              ; high: 2nd half of bit
000F80 EC3D F006      00106         call    delay_10
000F84 EC3D F006      00107         call    delay_10
000F88 EC3D F006      00108         call    delay_10
                      00109 ;       call    delay_10
000F8C 9681           00110         bcf             SDIO, S_DO              ; end bit
                      00111 
000F8E 2E01           00112         decfsz  ROTATE                  ; done byte?
000F90 EFA9 F007      00113         goto    send1wire2              ; if no - next window please
000F94 0012           00114         return                                  ; if yes
                      00115 
                      00116 
                      00117 
                      00118 
                      00119 ;       bcf             SDIO, S_DO              ; low: first half of bit
                      00120 ;       call    delay_10                ; reference delay time
                      00121 ;
                      00122 ;       bsf             SDIO, S_DO              ; high: 2nd half of bit
                      00123 ;       call    delay_8         ; first half of delay
                      00124 ;       rlcf    RWDATA                  ; shift leftmost bit into carry
                      00125 ;       btfss   STATUS, C               ; is 0?
                      00126 ;       call    delay_10                ; if yes - delay longer for '0' bit
                      00127 ;       bcf             SDIO, S_DO              ; end bit
                      00128 ;       decfsz  ROTATE
                      00129 ;       goto    send1wire2
                      00130 ;
                      00131 ;       return
                      00132 
                      00133 
                      00134 ; -------------------------------
                      00135 
                      00136 ;send1wire_start:
                      00137 ;       bsf             SDIO, S_DO              ; Start condition
                      00138 ;       call    delaybit                ; = 1 timer rollover on slaves
                      00139 ;;      call    delaybit                ; ...
                      00140 ;;      call    delaybit                ; ...
                      00141 ;;      call    delaybit                ; ...
                      00142 ;;      call    delaybit                ; ...
                      00143 ;       bcf             SDIO, S_DO              ; end start condition
                      00144 ;       call    delay_dt
                      00145 ;
                      00146 ;;      bsf             SDIO, S_DO              ; end start condition
                      00147 ;;      call    delayhalfbit
                      00148 ;;      bcf             SDIO, S_DO              ; end start condition
                      00149 ;       return
                      00150 
                      00151 
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00152 
                      00153 
                      00154 
000F96                00155 send1wire_start:
000F96 8681           00156         bsf             SDIO, S_DO              ; Start condition
000F98 EC3D F006      00157         call    delay_10
000F9C EC3D F006      00158         call    delay_10
                      00159 ;       call    delaybit                ; = 1 timer rollover on slaves
                      00160 ;       call    delaybit                ; ...
                      00161 ;       call    delaybit                ; ...
                      00162 ;       call    delaybit                ; ...
                      00163 ;       call    delaybit                ; ...
000FA0 9681           00164         bcf             SDIO, S_DO              ; end start condition
                      00165         ;call   delay_dt
                      00166 
                      00167 ;       bsf             SDIO, S_DO              ; end start condition
                      00168 ;       call    delayhalfbit
                      00169 ;       bcf             SDIO, S_DO              ; end start condition
000FA2 0012           00170         return
                      00303 #include        "ui.inc"
                      00001 ; $Id: $
                      00002 
                      00003 
                      00004 
                      00005 ; -------------------------
                      00006 
000FA4                00007 ui_main_menu:
                      00008         sendstring      str_menu
000FA4 0E00               M         movlw   upper   str_menu
000FA6 6EF8               M         movwf   TBLPTRU
000FA8 0E11               M         movlw   high    str_menu
000FAA 6EF7               M         movwf   TBLPTRH
000FAC 0EB2               M         movlw   low             str_menu
000FAE 6EF6               M         movwf   TBLPTRL
000FB0 EC2C F004          M         call    stringsender
                      00009         sendstring      str_menu_2
000FB4 0E00               M         movlw   upper   str_menu_2
000FB6 6EF8               M         movwf   TBLPTRU
000FB8 0E12               M         movlw   high    str_menu_2
000FBA 6EF7               M         movwf   TBLPTRH
000FBC 0E30               M         movlw   low             str_menu_2
000FBE 6EF6               M         movwf   TBLPTRL
000FC0 EC2C F004          M         call    stringsender
                      00010         sendstring      str_menu_3
000FC4 0E00               M         movlw   upper   str_menu_3
000FC6 6EF8               M         movwf   TBLPTRU
000FC8 0E12               M         movlw   high    str_menu_3
000FCA 6EF7               M         movwf   TBLPTRH
000FCC 0E74               M         movlw   low             str_menu_3
000FCE 6EF6               M         movwf   TBLPTRL
000FD0 EC2C F004          M         call    stringsender
                      00011 
000FD4 EC93 F006      00012         call    GETCMD
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000FD8 6E0C           00013         movwf   SCRATCH0
000FDA EFF2 F007      00014         goto    ui_main_menu_2
                      00015 
000FDE                00016 ui_main_menu_scan:
000FDE EC9C F006      00017         call    SCANCMD
000FE2 6E0C           00018         movwf   SCRATCH0
                      00019 
000FE4                00020 ui_main_menu_2:
000FE4 0E20           00021         movlw   ' '
000FE6 180C           00022         xorwf   SCRATCH0, w
000FE8 E031           00023         bz              ui_inc_color
                      00024 
000FEA 0E52           00025         movlw   'R'
000FEC 180C           00026         xorwf   SCRATCH0, w
000FEE E030           00027         bz              ui_toggle_r
                      00028 
000FF0 0E47           00029         movlw   'G'
000FF2 180C           00030         xorwf   SCRATCH0, w
000FF4 E02F           00031         bz              ui_toggle_g
                      00032 
000FF6 0E42           00033         movlw   'B'
000FF8 180C           00034         xorwf   SCRATCH0, w
000FFA E02E           00035         bz              ui_toggle_b
                      00036 
000FFC 0E2B           00037         movlw   '+'
000FFE 180C           00038         xorwf   SCRATCH0, w
001000 E02D           00039         bz              ui_intens_up
                      00040 
001002 0E2D           00041         movlw   '-'
001004 180C           00042         xorwf   SCRATCH0, w
001006 E02C           00043         bz              ui_intens_dn
                      00044 
001008 0E30           00045         movlw   '0'
00100A 180C           00046         xorwf   SCRATCH0, w
00100C E02B           00047         bz              ui_set_addr_0
                      00048 
00100E 0E31           00049         movlw   '1'
001010 180C           00050         xorwf   SCRATCH0, w
001012 E02B           00051         bz              ui_set_addr_1
                      00052 
001014 0E32           00053         movlw   '2'
001016 180C           00054         xorwf   SCRATCH0, w
001018 E02B           00055         bz              ui_set_addr_2
                      00056 
00101A 0E41           00057         movlw   'A'
00101C 180C           00058         xorwf   SCRATCH0, w
00101E E02F           00059         bz              ui_set_addr_x
                      00060 
001020 0E45           00061         movlw   'E'
001022 180C           00062         xorwf   SCRATCH0, w
001024 E042           00063         bz              ui_set_grp_addr
                      00064 
001026 0E2A           00065         movlw   '*'
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001028 180C           00066         xorwf   SCRATCH0, w
00102A E025           00067         bz              ui_inc_addr
                      00068 
00102C 0E2F           00069         movlw   '/'
00102E 180C           00070         xorwf   SCRATCH0, w
001030 E024           00071         bz              ui_dec_addr
                      00072 
001032 0E53           00073         movlw   'S'
001034 180C           00074         xorwf   SCRATCH0, w
001036 E05B           00075         bz              ui_set_full
                      00076 
001038 0E4E           00077         movlw   'N'
00103A 180C           00078         xorwf   SCRATCH0, w
00103C E06B           00079         bz              ui_set_none
                      00080 
00103E 0E58           00081         movlw   'X'
001040 180C           00082         xorwf   SCRATCH0, w
001042 E04F           00083         bz              ui_set_event
                      00084 
001044 0E5A           00085         movlw   'Z'
001046 180C           00086         xorwf   SCRATCH0, w
001048 E04F           00087         bz              ui_clear_event
                      00088 
00104A 0012           00089         return
                      00090 
                      00091 ;       movlw   'r'
                      00092 ;       xorwf   SCRATCH0, w
                      00093 ;       bz              ui_inc_r
                      00094 ;
                      00095 ;       movlw   'g'
                      00096 ;       xorwf   SCRATCH0, w
                      00097 ;       bz              ui_inc_g
                      00098 ;
                      00099 ;       movlw   'b'
                      00100 ;       xorwf   SCRATCH0, w
                      00101 ;       bz              ui_inc_b
                      00102 ;       return
                      00103 ;
                      00104 
00104C                00105 ui_inc_color:
00104C 2A1E           00106         incf    COLOR
00104E 0012           00107         return
                      00108 
001050                00109 ui_toggle_r:
001050 741E           00110         btg             COLOR, 2
001052 0012           00111         return
                      00112 
001054                00113 ui_toggle_g:
001054 721E           00114         btg             COLOR, 1
001056 0012           00115         return
                      00116 
001058                00117 ui_toggle_b:
001058 701E           00118         btg             COLOR, 0
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00105A 0012           00119         return
                      00120 
00105C                00121 ui_intens_up:
00105C 2A1D           00122         incf    INTENS
00105E 0012           00123         return
                      00124 
001060                00125 ui_intens_dn:
001060 061D           00126         decf    INTENS
001062 0012           00127         return
                      00128 
001064                00129 ui_set_addr_0
001064 0E00           00130         movlw   H'00'
001066 6E1F           00131         movwf   ADDR
001068 0012           00132         return
                      00133 
00106A                00134 ui_set_addr_1
00106A 0E01           00135         movlw   H'01'
00106C 6E1F           00136         movwf   ADDR
00106E 0012           00137         return
                      00138 
001070                00139 ui_set_addr_2
001070 0E02           00140         movlw   H'02'
001072 6E1F           00141         movwf   ADDR
001074 0012           00142         return
                      00143 
001076                00144 ui_inc_addr:
001076 2A1F           00145         incf    ADDR
001078 0012           00146         return
                      00147 
00107A                00148 ui_dec_addr:
00107A 061F           00149         decf    ADDR
00107C 0012           00150         return
                      00151 
00107E                00152 ui_set_addr_x:
                      00153         sendstring      str_addr
00107E 0E00               M         movlw   upper   str_addr
001080 6EF8               M         movwf   TBLPTRU
001082 0E12               M         movlw   high    str_addr
001084 6EF7               M         movwf   TBLPTRH
001086 0EB8               M         movlw   low             str_addr
001088 6EF6               M         movwf   TBLPTRL
00108A EC2C F004          M         call    stringsender
00108E EC93 F006      00154         call    GETCMD
001092 6E0A           00155         movwf   SERR01
001094 EC87 F006      00156         call    SENDCMNDP2              ; local echo
001098 EC93 F006      00157         call    GETCMD
00109C 6E0B           00158         movwf   SERR02
00109E EC87 F006      00159         call    SENDCMNDP2              ; local echo
0010A2 ECDB F006      00160         call    ASCII2HEX               ; char[2] to byte, in WREG
0010A6 6E1F           00161         movwf   ADDR
0010A8 0012           00162         return
                      00163 
0010AA                00164 ui_set_grp_addr:
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00165         sendstring      str_dest_addr
0010AA 0E00               M         movlw   upper   str_dest_addr
0010AC 6EF8               M         movwf   TBLPTRU
0010AE 0E12               M         movlw   high    str_dest_addr
0010B0 6EF7               M         movwf   TBLPTRH
0010B2 0EC0               M         movlw   low             str_dest_addr
0010B4 6EF6               M         movwf   TBLPTRL
0010B6 EC2C F004          M         call    stringsender
0010BA EC93 F006      00166         call    GETCMD
0010BE 6E0A           00167         movwf   SERR01
0010C0 EC87 F006      00168         call    SENDCMNDP2              ; local echo
0010C4 EC93 F006      00169         call    GETCMD
0010C8 6E0B           00170         movwf   SERR02
0010CA EC87 F006      00171         call    SENDCMNDP2              ; local echo
0010CE ECDB F006      00172         call    ASCII2HEX               ; char[2] to byte, in WREG
0010D2 0B0F           00173         andlw   B'00001111'             ; low nibble only
0010D4 0980           00174         iorlw   B'10000000'             ; set Extended Command bit (cmd is 000)
0010D6 6E20           00175         movwf   COMMAND
0010D8 ECCE F008      00176         call    ui_show_packet
0010DC EC9B F007      00177         call    send1wire
0010E0 0012           00178         return
                      00179 
0010E2                00180 ui_set_event:
0010E2 EC16 F019      00181         call    event_pos
0010E6 0012           00182         return
                      00183 
0010E8                00184 ui_clear_event:
0010E8 EC2A F019      00185         call    event_neg
0010EC 0012           00186         return
                      00187 
0010EE                00188 ui_set_full:
0010EE EE01 F004      00189         lfsr    FSR0, ADDRTBL+1 +3
0010F2 0E07           00190         movlw   B'00000111'     ; max. + 1
0010F4 6EEE           00191         movwf   POSTINC0        ; R
0010F6 6EEE           00192         movwf   POSTINC0        ; G
0010F8 6EEE           00193         movwf   POSTINC0        ; B
                      00194 
0010FA EE01 F00C      00195         lfsr    FSR0, ADDRTBL+1+8 +3
0010FE 0E07           00196         movlw   B'00000111'     ; max. + 1
001100 6EEE           00197         movwf   POSTINC0        ; R
                      00198 
001102 EE01 F015      00199         lfsr    FSR0, ADDRTBL+1+D'16'+1 +3
001106 0E07           00200         movlw   B'00000111'     ; max. + 1
001108 6EEE           00201         movwf   POSTINC0        ; G
                      00202 
00110A EE01 F01E      00203         lfsr    FSR0, ADDRTBL+1+D'24'+2 +3
00110E 0E07           00204         movlw   B'00000111'     ; max. + 1
001110 6EEE           00205         movwf   POSTINC0        ; B
                      00206 
001112 0012           00207         return
                      00208 
001114                00209 ui_set_none:
001114 EE01 F004      00210         lfsr    FSR0, ADDRTBL+1 +3
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001118 0E00           00211         movlw   B'00000000'     ; 
00111A 6EEE           00212         movwf   POSTINC0        ; R
00111C 6EEE           00213         movwf   POSTINC0        ; G
00111E 6EEE           00214         movwf   POSTINC0        ; B
                      00215 
001120 EE01 F00C      00216         lfsr    FSR0, ADDRTBL+1+8 +3
001124 0E00           00217         movlw   B'00000000'     ; 
001126 6EEE           00218         movwf   POSTINC0        ; R
001128 6EEE           00219         movwf   POSTINC0        ; G
00112A 6EEE           00220         movwf   POSTINC0        ; B
                      00221 
00112C EE01 F014      00222         lfsr    FSR0, ADDRTBL+1+D'16'+3
001130 0E00           00223         movlw   B'00000000'     ; 
001132 6EEE           00224         movwf   POSTINC0        ; R
001134 6EEE           00225         movwf   POSTINC0        ; G
001136 6EEE           00226         movwf   POSTINC0        ; B
                      00227 
001138 EE01 F01C      00228         lfsr    FSR0, ADDRTBL+1+D'24' +3
00113C 0E00           00229         movlw   B'00000000'     ; 
00113E 6EEE           00230         movwf   POSTINC0        ; R
001140 6EEE           00231         movwf   POSTINC0        ; G
001142 6EEE           00232         movwf   POSTINC0        ; B
                      00233 
001144 0012           00234         return
                      00235 
                      00236 
                      00237 
                      00238 ; --------------------------
001146                00239 ui_inc_r:
001146 2A21           00240         incf    INTENS_R
001148 EFAC F008      00241         goto    ui_inc_color_x
                      00242 
00114C                00243 ui_inc_g:
00114C 2A22           00244         incf    INTENS_G
00114E EFAC F008      00245         goto    ui_inc_color_x
                      00246 
001152                00247 ui_inc_b:
001152 2A23           00248         incf    INTENS_B
001154 EFAC F008      00249         goto    ui_inc_color_x
                      00250 
001158                00251 ui_inc_color_x:
001158 6A1E           00252         clrf    COLOR
00115A 841E           00253         bsf             COLOR, 2
00115C C021 F01D      00254         movff   INTENS_R, INTENS
001160 ECFD F004      00255         call    sendcmdbyte
                      00256 
001164 6A1E           00257         clrf    COLOR
001166 821E           00258         bsf             COLOR, 1
001168 C022 F01D      00259         movff   INTENS_G, INTENS
00116C ECFD F004      00260         call    sendcmdbyte
                      00261 
001170 6A1E           00262         clrf    COLOR
001172 801E           00263         bsf             COLOR, 0
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001174 C023 F01D      00264         movff   INTENS_B, INTENS
001178 ECFD F004      00265         call    sendcmdbyte
00117C 6A1E           00266         clrf    COLOR
00117E 0012           00267         return
                      00268 ; --------------------------
                      00269 
001180                00270 ui_show_addr:
                      00271         sendstring      str_addr
001180 0E00               M         movlw   upper   str_addr
001182 6EF8               M         movwf   TBLPTRU
001184 0E12               M         movlw   high    str_addr
001186 6EF7               M         movwf   TBLPTRH
001188 0EB8               M         movlw   low             str_addr
00118A 6EF6               M         movwf   TBLPTRL
00118C EC2C F004          M         call    stringsender
001190 501F           00272         movf    ADDR, w
001192 ECBE F006      00273         call    SENDHEX
001196 EC8C F006      00274         call    SENDCMNDP2CR
00119A 0012           00275         return
                      00276 
                      00277 ; --------------------------
                      00278 
00119C                00279 ui_show_packet:
00119C EC8C F006      00280         call    SENDCMNDP2CR
0011A0 501F           00281         movf    ADDR, w
0011A2 EC5D F007      00282         call    sendbin
0011A6 5020           00283         movf    COMMAND, w
0011A8 EC5D F007      00284         call    sendbin
0011AC EC8C F006      00285         call    SENDCMNDP2CR
0011B0 0012           00286         return
                      00287 
                      00288 ; --------------------------
                      00289 
0011B2                00290 str_menu:
0011B2 733C 6170 6563 00291         DW      "<space> change color \r\n+       brightness up\r\n-       brightness down\r\nR/G/B   to
                            ggle color\r\n* and / change addr up or down\r\n\x00"
       203E 6863 6E61 
       6567 6320 6C6F 
       726F 0D20 2B0A 
       2020 2020 2020 
       6220 6972 6867 
       6E74 7365 2073 
       7075 0A0D 202D 
       2020 2020 2020 
       7262 6769 7468 
       656E 7373 6420 
       776F 0D6E 520A 
       472F 422F 2020 
       7420 676F 6C67 
       2065 6F63 6F6C 
       0D72 2A0A 6120 
       646E 2F2
001230                00292 str_menu_2:
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001230 2041 2020 2020 00293         DW      "A      set explicit address\r\nE       set target's group address\r\n\r\n\x00" 
       7320 7465 6520 
       7078 696C 6963 
       2074 6461 7264 
       7365 0D73 450A 
       2020 2020 2020 
       7320 7465 7420 
       7261 6567 2774 
       2073 7267 756F 
       2070 6461 7264 
       7365 0D73 0D0A 
       000A 
001274                00294 str_menu_3:
001274 2072 2020 2020 00295         DW      "r      inc red only\r\ng       inc green only\r\nb     inc blue only\r\n\x00"
       6920 636E 7220 
       6465 6F20 6C6E 
       0D79 670A 2020 
       2020 2020 6920 
       636E 6720 6572 
       6E65 6F20 6C6E 
       0D79 620A 2020 
       2020 6920 636E 
       6220 756C 2065 
       6E6F 796C 0A0D 
       0000 
                      00296 
                      00297 
0012B8                00298 str_addr:
0012B8 6441 7264 203A 00299         DW      "Addr: \x00"
       0000 
                      00300 
0012C0                00301 str_dest_addr:
0012C0 7247 756F 2070 00302         DW      "Group addr: \x00"
       6461 7264 203A 
       0000 
                      00304 #include        "chain.inc"
                      00001 
                      00002 
                      00003 ; Node color table in memory:
                      00004 
                      00005 
                      00006 
                      00007 ; FSR1: Color table ptr
                      00008 
                      00009 ; TBLPTRx: Random table ptr
                      00010 
0012CE                00011 chain:
0012CE                00012 chain_init:
0012CE EE11 F000      00013         lfsr    FSR1, ADDRTBL   ; point to start of address table
0012D2 0E00           00014         movlw   UPPER   str_chain       ; point to start of address chain in ROM
0012D4 6EF8           00015         movwf   TBLPTRU                         ; ...
0012D6 0E32           00016         movlw   HIGH    str_chain
0012D8 6EF7           00017         movwf   TBLPTRH
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0012DA 0EF2           00018         movlw   LOW             str_chain
0012DC 6EF6           00019         movwf   TBLPTRL
                      00020 
0012DE                00021 chain_init_2:
0012DE 0009           00022         TBLRD*+                                         ; load address and post-increment
0012E0 CFF5 FFE6      00023         movff   TABLAT, POSTINC1        ; store address
0012E4 6AE6           00024         clrf    POSTINC1                        ; and clear 3 intensity bytes that follow
0012E6 6AE6           00025         clrf    POSTINC1                        ; ...
0012E8 6AE6           00026         clrf    POSTINC1                        ;
                      00027 
0012EA 6AE6           00028         clrf    POSTINC1                        ; final R
0012EC 6AE6           00029         clrf    POSTINC1                        ; final G
0012EE 6AE6           00030         clrf    POSTINC1                        ; final B
0012F0 6AE6           00031         clrf    POSTINC1                        ; flags
                      00032 
0012F2 66F5           00033         tstfsz  TABLAT                          ; address byte from chain zero?
0012F4 EF6F F009      00034         goto    chain_init_2            ; if no - more addresses to read, keep reading  
                      00035 
                      00036 
                      00037 
                      00038 
                      00039 
0012F8                00040 chain_init_3:
0012F8 0E00           00041         movlw   UPPER   str_rand        ; point to start of random number table
0012FA 6EF8           00042         movwf   TBLPTRU                         ; ...
0012FC 0E30           00043         movlw   HIGH    str_rand
0012FE 6EF7           00044         movwf   TBLPTRH
001300 0E00           00045         movlw   LOW             str_rand
001302 6EF6           00046         movwf   TBLPTRL
                      00047 
001304 0012           00048         return
                      00049 
                      00050 ;       lfsr    FSR1, ADDRTBL   ; point to start of address table
                      00051 
001306                00052 chain_loop:
001306 EC80 F018      00053         call    fade
00130A EF83 F009      00054         goto    chain_loop
                      00055 
                      00056 
                      00057 #ifdef COMMENTED
                      00058 
                      00059 ; -----------
                      00060 ; Given an address, color(s) and target intensity, fade from current intensity to that one
                      00061 
                      00062 fade:
                      00063         call    delay20sec              ; HACK: Slow things down enough to see...
                      00064 ;       movlw B'11111100'               ; 
                      00065 ;       andwf   FSR1L                   ; Point to 1st (address) byte of 4-byte table entry
                      00066         movff   POSTINC1, ADDR
                      00067         movlw   H'00'                   ;
                      00068         xorwf   ADDR, w                 ; 'ADDR' 0? (end of table)
                      00069         bnz             fade_red                ; if no
                      00070 
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00071         lfsr    FSR1, ADDRTBL   ; if yes - Reset to start of table
                      00072         movff   POSTINC1, ADDR  ; and load address
                      00073 
                      00074 fade_red:
                      00075         movlw   B'00000100'
                      00076         movwf   COLOR
                      00077         call    fader
                      00078 fade_green:
                      00079         movlw   B'00000010'
                      00080         movwf   COLOR
                      00081         call    fader
                      00082 fade_blue:
                      00083         movlw   B'00000001'
                      00084         movwf   COLOR
                      00085         call    fader
                      00086 
                      00087         return
                      00088 
                      00089 
                      00090 
                      00091 fader:
                      00092         movff   INDF1, SCRATCH1
                      00093         movff   SCRATCH1, INTENS
                      00094 ;       movff   SCRATCH1, SCRATCH2
                      00095 ;       movf    SCRATCH1, w
                      00096         incf    TBLPTRL
                      00097         TBLRD*
                      00098         movf    TABLAT, w
                      00099 
                      00100         andlw   B'00001111'                     ; constrain intensity
                      00101 
                      00102 
                      00103         movwf   SCRATCH2                        ; new intensity
                      00104         subwf   SCRATCH1, w                     ; w = SCRATCH1 - SCRATCH2 = old - new
                      00105         bz              fade_done
                      00106         bnc             fade_up                         ; if neg (new intensity greater)
                      00107 
                      00108 fade_down:
                      00109         decf    INTENS
                      00110         call    sendcmdbyte
                      00111 ;       call    delaysec
                      00112         movf    INTENS, w
                      00113         cpfseq  SCRATCH2                        ; INTENS = desired value?
                      00114         goto    fade_down
                      00115         goto    fade_done
                      00116 
                      00117 
                      00118 
                      00119 fade_up:
                      00120         incf    INTENS
                      00121         call    sendcmdbyte
                      00122 ;       call    delaysec
                      00123         movf    INTENS, w
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00124         cpfseq  SCRATCH2                        ; INTENS = desired value?
                      00125         goto    fade_up
                      00126         goto    fade_done
                      00127 
                      00128 fade_done:
                      00129         movff   INTENS, INDF1
                      00130         movf    POSTINC1, w                     ; dummy increment
                      00131         return
                      00132 endif
                      00305 #include        "rand.inc"
                      00001 ; $Id: $
                      00002 
                      00003 ; Random colors table generated by rand.pl
                      00004 
                      00005 
                      00006 ; ----------------------------------------------
                      00007 
                      00008 
00130E                00009 init_rand:
00130E 0E00           00010         movlw   UPPER   str_rand        ; point to start of random number table
001310 6EF8           00011         movwf   TBLPTRU                         ; ...
001312 0E30           00012         movlw   HIGH    str_rand
001314 6EF7           00013         movwf   TBLPTRH
001316 0E00           00014         movlw   LOW             str_rand
001318 6EF6           00015         movwf   TBLPTRL
00131A 0012           00016         return
                      00017 
                      00018 
                      00019 ; ----------------------------------------------
                      00020 
00131C                00021 get_rand:
00131C 2AF6           00022         incf    TBLPTRL         ; inc. low byte only - will rollover forever
00131E 0008           00023         TBLRD*
001320 50F5           00024         movf    TABLAT, w
001322 0B0F           00025         andlw   B'00001111'
001324 0012           00026         return
                      00027 
                      00028 
003000                00029         org 0x3000
                      00030 
003000                00031 str_rand:
003000 0801           00032         DW H'0801'
003002 0004           00033         DW H'0004'
003004 0406           00034         DW H'0406'
003006 0800           00035         DW H'0800'
003008 0002           00036         DW H'0002'
00300A 0002           00037         DW H'0002'
00300C 0201           00038         DW H'0201'
00300E 0001           00039         DW H'0001'
003010 0507           00040         DW H'0507'
003012 0100           00041         DW H'0100'
003014 0103           00042         DW H'0103'
003016 0002           00043         DW H'0002'
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003018 0102           00044         DW H'0102'
00301A 0001           00045         DW H'0001'
00301C 0103           00046         DW H'0103'
00301E 0600           00047         DW H'0600'
003020 0005           00048         DW H'0005'
003022 0204           00049         DW H'0204'
003024 0400           00050         DW H'0400'
003026 0301           00051         DW H'0301'
003028 0008           00052         DW H'0008'
00302A 0607           00053         DW H'0607'
00302C 0706           00054         DW H'0706'
00302E 0500           00055         DW H'0500'
003030 0400           00056         DW H'0400'
003032 0300           00057         DW H'0300'
003034 0004           00058         DW H'0004'
003036 0701           00059         DW H'0701'
003038 0201           00060         DW H'0201'
00303A 0700           00061         DW H'0700'
00303C 0606           00062         DW H'0606'
00303E 0307           00063         DW H'0307'
003040 0302           00064         DW H'0302'
003042 0000           00065         DW H'0000'
003044 0004           00066         DW H'0004'
003046 0601           00067         DW H'0601'
003048 0000           00068         DW H'0000'
00304A 0000           00069         DW H'0000'
00304C 0005           00070         DW H'0005'
00304E 0300           00071         DW H'0300'
003050 0600           00072         DW H'0600'
003052 0303           00073         DW H'0303'
003054 0500           00074         DW H'0500'
003056 0702           00075         DW H'0702'
003058 0003           00076         DW H'0003'
00305A 0806           00077         DW H'0806'
00305C 0500           00078         DW H'0500'
00305E 0500           00079         DW H'0500'
003060 0100           00080         DW H'0100'
003062 0400           00081         DW H'0400'
003064 0001           00082         DW H'0001'
003066 0008           00083         DW H'0008'
003068 0206           00084         DW H'0206'
00306A 0007           00085         DW H'0007'
00306C 0303           00086         DW H'0303'
00306E 0800           00087         DW H'0800'
003070 0000           00088         DW H'0000'
003072 0100           00089         DW H'0100'
003074 0103           00090         DW H'0103'
003076 0000           00091         DW H'0000'
003078 0000           00092         DW H'0000'
00307A 0708           00093         DW H'0708'
00307C 0805           00094         DW H'0805'
00307E 0105           00095         DW H'0105'
003080 0700           00096         DW H'0700'
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003082 0000           00097         DW H'0000'
003084 0703           00098         DW H'0703'
003086 0600           00099         DW H'0600'
003088 0603           00100         DW H'0603'
00308A 0800           00101         DW H'0800'
00308C 0303           00102         DW H'0303'
00308E 0002           00103         DW H'0002'
003090 0800           00104         DW H'0800'
003092 0102           00105         DW H'0102'
003094 0500           00106         DW H'0500'
003096 0802           00107         DW H'0802'
003098 0403           00108         DW H'0403'
00309A 0000           00109         DW H'0000'
00309C 0007           00110         DW H'0007'
00309E 0007           00111         DW H'0007'
0030A0 0101           00112         DW H'0101'
0030A2 0704           00113         DW H'0704'
0030A4 0200           00114         DW H'0200'
0030A6 0001           00115         DW H'0001'
0030A8 0003           00116         DW H'0003'
0030AA 0000           00117         DW H'0000'
0030AC 0302           00118         DW H'0302'
0030AE 0603           00119         DW H'0603'
0030B0 0002           00120         DW H'0002'
0030B2 0008           00121         DW H'0008'
0030B4 0306           00122         DW H'0306'
0030B6 0700           00123         DW H'0700'
0030B8 0300           00124         DW H'0300'
0030BA 0106           00125         DW H'0106'
0030BC 0104           00126         DW H'0104'
0030BE 0100           00127         DW H'0100'
0030C0 0103           00128         DW H'0103'
0030C2 0208           00129         DW H'0208'
0030C4 0000           00130         DW H'0000'
0030C6 0104           00131         DW H'0104'
0030C8 0502           00132         DW H'0502'
0030CA 0800           00133         DW H'0800'
0030CC 0207           00134         DW H'0207'
0030CE 0002           00135         DW H'0002'
0030D0 0302           00136         DW H'0302'
0030D2 0000           00137         DW H'0000'
0030D4 0408           00138         DW H'0408'
0030D6 0607           00139         DW H'0607'
0030D8 0103           00140         DW H'0103'
0030DA 0401           00141         DW H'0401'
0030DC 0000           00142         DW H'0000'
0030DE 0502           00143         DW H'0502'
0030E0 0707           00144         DW H'0707'
0030E2 0507           00145         DW H'0507'
0030E4 0002           00146         DW H'0002'
0030E6 0701           00147         DW H'0701'
0030E8 0000           00148         DW H'0000'
0030EA 0804           00149         DW H'0804'
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0030EC 0006           00150         DW H'0006'
0030EE 0505           00151         DW H'0505'
0030F0 0600           00152         DW H'0600'
0030F2 0100           00153         DW H'0100'
0030F4 0305           00154         DW H'0305'
0030F6 0008           00155         DW H'0008'
0030F8 0503           00156         DW H'0503'
0030FA 0301           00157         DW H'0301'
0030FC 0402           00158         DW H'0402'
0030FE 0101           00159         DW H'0101'
                      00160 
                      00161 ; Total 128 lines
                      00162 ; (256 bytes)
                      00306 #include        "effects.inc"
                      00001 ; $Id: $
                      00002 
                      00003 ; Effects modules
                      00004 
                      00005 ; Revised chain table: [ADDR] [Rc] [Gc] [Bc] [Rf] [Gf] [Bf] [flags]
                      00006 
                      00007 ; ----------------------------------------------
                      00008 ; Smoothly transition from values in xc to xf.
                      00009 ; Algo: If xf>xc, inc xc
                      00010 ;               If xf<xc, dec xc
                      00011 ;               If xf==xc, no change
                      00012 
003100                00013 effect0:
003100                00014 fade:
                      00015 
                      00016         ;call   delaysec        ; debug
003100 EC2C F006      00017         call    delaybit
003104 EC2C F006      00018         call    delaybit
003108 EC2C F006      00019         call    delaybit
00310C EC2C F006      00020         call    delaybit
003110 EC2C F006      00021         call    delaybit
                      00022 
003114 EE01 F000      00023         lfsr    FSR0, ADDRTBL   ; point to address
003118 EE11 F000      00024         lfsr    FSR1, ADDRTBL
                      00025 
00311C 0E04           00026         movlw   H'04'   ;  FSR0 = (node)
00311E 26E1           00027         addwf   FSR1L
003120 6AE8           00028         clrf    WREG    ; FSR1 = (node+4)       (point to Rf)
003122 22E2           00029         addwfc  FSR1H           
                      00030 
003124                00031 fade1:
                      00032 
003124 50EE           00033         movf    POSTINC0, w             ; fetch ADDR, get zero status
003126 B4D8           00034         btfsc   STATUS, Z               ; 0 (chain terminator)?
003128 0012           00035         return                                  ; if yes
00312A 6E1F           00036         movwf   ADDR                    ; else
                      00037 
                      00038 ;       call    SENDHEX ; debug
                      00039 ;       call    SENDCMNDP2CR
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00040 
00312C 0E04           00041         movlw   B'00000100'     ; start with Red
00312E 6E1E           00042         movwf   COLOR
                      00043 
                      00044                                                         ; now FSR0 = Rc
003130                00045 fade2:
                      00046 
                      00047         ; for x= 1 to 3...
                      00048 
003130 50E6           00049         movf    POSTINC1, w     ; Rf
                      00050 
                      00051         ; ---debug---
                      00052 ;       movwf   SCRATCH5
                      00053 ;       call    sendbin
                      00054 ;       movlw   ' '
                      00055 ;       call    SENDCMNDP2
                      00056 ;       movf    INDF0, w
                      00057 ;       call    sendbin
                      00058 ;       call    SENDCMNDP2CR
                      00059 ;       movf    SCRATCH5, w
                      00060         ; ---end debug---
                      00061 
003132 5CEF           00062         subwf   INDF0, w        ; Rc
                      00063 
003134 E00B           00064         bz              fade_same
                      00065 
003136 E205           00066         bc              fade_down                       ;;;; = bn ; Current value greater; fade down
                      00067                                                                 ; else
003138                00068 fade_up:
003138 2AEF           00069         incf    INDF0
00313A CFEE F01D      00070         movff   POSTINC0, INTENS
00313E EFA9 F018      00071         goto    fade_send
                      00072 
                      00073 
003142                00074 fade_down:
003142 06EF           00075         decf    INDF0
003144 CFEE F01D      00076         movff   POSTINC0, INTENS
003148 EFA9 F018      00077         goto    fade_send
                      00078 
                      00079 
00314C                00080 fade_same:      ; Next color...
                      00081 
                      00082 ;       call    delaysec        ; debug
                      00083 ;       call    delaysec        ; debug
                      00084 
00314C 50EE           00085         movf    POSTINC0, w                     ; dummy read
00314E EFAB F018      00086         goto    fade_nextcolor
                      00087 
003152                00088 fade_send:      ; ADDR, INTENS and COLOR already set up
003152 ECFD F004      00089         call    sendcmdbyte
                      00090 
003156                00091 fade_nextcolor:
                      00092 
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

003156 421E           00093         rrncf   COLOR
003158 AE1E           00094         btfss   COLOR, 7        ; wraparound?
00315A EF98 F018      00095         goto    fade2           ; if no
                      00096                                                 ; else
00315E 0E04           00097         movlw   H'04'
003160 26E9           00098         addwf   FSR0L
003162 6AE8           00099         clrf    WREG
003164 22EA           00100         addwfc  FSR0H
003166 0E05           00101         movlw   H'05'   ; skip flags byte for now too...
003168 26E1           00102         addwf   FSR1L
00316A 6AE8           00103         clrf    WREG
00316C 22E2           00104         addwfc  FSR1H
                      00105 
00316E EF92 F018      00106         goto    fade1
                      00107 
                      00108 
                      00109 ; ----------------------------------------------
                      00110 ; Given value in Xf, distribute 1 of its intensity steps to each of its nearest neighbors
                      00111 ; For efficiency, requires 1 node worth of padding on either side of the node table.
                      00112 
                      00113 ; There are probably better ways to do this.
                      00114 
                      00115 
                      00116 ;       FC      Rf
                      00117 ;       FD      Gf
                      00118 ;       FE      Bf
                      00119 ;..FF   flags
                      00120 ;       0       addr0
                      00121 ;       1       Rc
                      00122 ;       2       Gc
                      00123 ;       3       Bc
                      00124 ;       4       Rf
                      00125 ;       5       Gf
                      00126 ;       6       Bf
                      00127 ;       7       flags
                      00128 ;       8       addr1
                      00129 ;       9       Rc
                      00130 ;       A       Gc
                      00131 ;       B       Bc
                      00132 ;       C       Rf
                      00133 ;       D       Gf
                      00134 ;       E       Bf
                      00135 ;       F       flags
                      00136 
003172                00137 effect1:
003172                00138 diffuse:
                      00139 
003172 EE00 F0FC      00140         lfsr    FSR0, ADDRTBL-D'4'              ; Rf of "previous"
003176 EE11 F000      00141         lfsr    FSR1, ADDRTBL           ; addr of current
00317A EE21 F00C      00142         lfsr    FSR2, ADDRTBL+D'12'     ; Rf of next
                      00143 
                      00144 ;       movlw   H'04'   ;  FSR0 = (node)
                      00145 ;       addwf   FSR1L
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00146 ;       clrf    WREG    ; FSR1 = (node+4)
                      00147 ;       addwfc  FSR1H
                      00148 
00317E                00149 diffuse1:
                      00150 
00317E EC7F F007      00151         call    showfsr ; debug
                      00152 
003182 50E6           00153         movf    POSTINC1, w             ; fetch ADDR, get zero status
003184 B4D8           00154         btfsc   STATUS, Z               ; 0 (chain terminator)?
003186 0012           00155         return                                  ; if yes
003188 6E1F           00156         movwf   ADDR                    ; else
                      00157 
00318A ECBE F006      00158         call    SENDHEX ; debug
00318E EC8C F006      00159         call    SENDCMNDP2CR
                      00160 
003192 0E03           00161         movlw   H'03'                   ; point to Rf
003194 26E1           00162         addwf   FSR1L                   ;
003196 6AE8           00163         clrf    WREG                    ;
003198 22E2           00164         addwfc  FSR1H                   ;
                      00165 
00319A 0E03           00166         movlw   H'03'                   ; iterations (==R,G,B)
00319C 6E0C           00167         movwf   SCRATCH0
                      00168 
                      00169 
                      00170 
                      00171 
                      00172                                                         ; now FSR0 = Rc
                      00173                                                         ; FSR1,2 = addr(n+1)
00319E                00174 diffuse2:
00319E 50E7           00175         movf    INDF1, w                ; dummy fetch to test zero status
0031A0 E006           00176         bz              diffuse2end             ; already depleted? If yes
                      00177                                                         ; else...
0031A2 06E7           00178         decf    INDF1                   ; steal 1 from current node
0031A4 2ADF           00179         incf    INDF2                   ; pass it to next node - light will prefer to diffuse "left to r
                            ight"
                      00180 
0031A6 50E7           00181         movf    INDF1, w                ; dummy fetch to test zero status, again...
0031A8 E002           00182         bz              diffuse2end             ; already depleted? If yes
                      00183                                                         ; else...
0031AA 06E7           00184         decf    INDF1                   ; steal 1 from current node
0031AC 2AEF           00185         incf    INDF0                   ; pass it to prev. node - light will prefer to diffuse "left to 
                            right"
                      00186 
0031AE                00187 diffuse2end
0031AE 50EE           00188         movf    POSTINC0, w             ; advance all pointers to next color
0031B0 50E6           00189         movf    POSTINC1, w             ;
0031B2 50DE           00190         movf    POSTINC2, w             ;
                      00191 
0031B4 2E0C           00192         decfsz  SCRATCH0                ; all colors done?
0031B6 EFCF F018      00193         goto    diffuse2                ; if no
                      00194 
0031BA 0E05           00195         movlw   H'05'                   ; FSR0 = *(n Rf)
0031BC 26E9           00196         addwf   FSR0L                   ;
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0031BE 6AE8           00197         clrf    WREG                    ;
0031C0 22EA           00198         addwfc  FSR0H                   ;
                      00199 
0031C2 50E6           00200         movf    POSTINC1, w             ; skip 'flags'
                      00201 
0031C4 0E05           00202         movlw   H'05'                   ; FSR2 = *(n+1 Rf)
0031C6 26D9           00203         addwf   FSR2L                   ;
0031C8 6AE8           00204         clrf    WREG                    ;
0031CA 22DA           00205         addwfc  FSR2H                   ;
                      00206 
                      00207 
                      00208 
0031CC 0E69           00209         movlw   'i'
0031CE EC87 F006      00210         call    SENDCMNDP2
                      00211 
0031D2 EFBF F018      00212         goto    diffuse1
                      00213 
                      00214 
                      00215 ; ----------------------------------------------
                      00216 ; Set Xc = Xf and send the appropriate commands
                      00217 
0031D6                00218 effect_set:
                      00219 
0031D6 EE01 F000      00220         lfsr    FSR0, ADDRTBL   ; point to start of chain (first address)
0031DA EE11 F000      00221         lfsr    FSR1, ADDRTBL   ; point to start of chain (first address)
                      00222 
0031DE 0E04           00223         movlw   H'04'   ;  FSR0 = (node)
0031E0 26E1           00224         addwf   FSR1L
0031E2 6AE8           00225         clrf    WREG    ; FSR1 = (node+4)       (point to Rf)
0031E4 22E2           00226         addwfc  FSR1H           
                      00227 
0031E6                00228 set1:
                      00229 
                      00230 ;       movf    FSR0H, w
                      00231 ;       call    SENDHEX
                      00232 ;       movf    FSR0L, w
                      00233 ;       call    SENDHEX
                      00234 ;       movlw   ':'
                      00235 ;       call    SENDCMNDP2
                      00236 ;
                      00237 ;       movf    INDF0, w
                      00238 ;       call    SENDHEX ; debug
                      00239 ;       movlw   ' '
                      00240 ;       call    SENDCMNDP2
                      00241 
                      00242 
0031E6 50EE           00243         movf    POSTINC0, w             ; fetch ADDR, get zero status
0031E8 B4D8           00244         btfsc   STATUS, Z               ; 0 (chain terminator)?
0031EA 0012           00245         return                                  ; if yes
0031EC 6E1F           00246         movwf   ADDR                    ; else
                      00247 
0031EE 0E04           00248         movlw   B'00000100'     ; start with Red
0031F0 6E1E           00249         movwf   COLOR
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 45


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00250                                                         ; currently FSR0=Rc, FSR1 = Rf
0031F2 50E6           00251         movf    POSTINC1, w
0031F4 6EEE           00252         movwf   POSTINC0
0031F6 6E1D           00253         movwf   INTENS
                      00254 
0031F8 ECFD F004      00255         call    sendcmdbyte
                      00256 
                      00257         ; lather rinse repeat for Green
0031FC 0E02           00258         movlw   B'00000010'     ; Green
0031FE 6E1E           00259         movwf   COLOR
                      00260                                                         ; currently FSR0=Gc, FSR1 = Gf
003200 50E6           00261         movf    POSTINC1, w
003202 6EEE           00262         movwf   POSTINC0
003204 6E1D           00263         movwf   INTENS
                      00264 
003206 ECFD F004      00265         call    sendcmdbyte
                      00266 
                      00267         ; lather rinse repeat for Blue
00320A 0E01           00268         movlw   B'00000001'     ; Blue
00320C 6E1E           00269         movwf   COLOR
                      00270                                                         ; currently FSR0=Bc, FSR1 = Bf
00320E 50E6           00271         movf    POSTINC1, w
003210 6EEE           00272         movwf   POSTINC0
003212 6E1D           00273         movwf   INTENS
                      00274 
003214 ECFD F004      00275         call    sendcmdbyte
                      00276 
                      00277 
003218 0E04           00278         movlw   H'04'
00321A 26E9           00279         addwf   FSR0L
00321C 6AE8           00280         clrf    WREG
00321E 22EA           00281         addwfc  FSR0H
003220 0E05           00282         movlw   H'05'   ; skip flags byte for now too...
003222 26E1           00283         addwf   FSR1L
003224 6AE8           00284         clrf    WREG
003226 22E2           00285         addwfc  FSR1H
                      00286 
                      00287 
003228 EFF3 F018      00288         goto    set1                    ; this node written, next please...
                      00307 #include        "event.inc"
                      00001 ; $Id: $
                      00002 
                      00003 ; Respond to an event...
                      00004 
                      00005 
                      00006 
                      00007 
                      00008 
                      00009 ; ----------------------------------------------
                      00010 ; Respond to a (low-to-high) positive interrupt event.
                      00011 ; Pull light intensities from the RNG table and write them (R,G,B) to every chain node.
                      00012 
00322C                00013 event_pos:
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 46


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00014 
                      00015 
                      00016 
00322C EE01 F000      00017         lfsr    FSR0, ADDRTBL   ; point to start of chain (first address)
                      00018 
                      00019 
                      00020 ;       movlw   H'04'   ;  FSR0 = (node)
                      00021 ;       addwf   FSR1L
                      00022 ;       clrf    WREG    ; FSR1 = (node+4)       (point to Rf)
                      00023 ;       addwfc  FSR1H           
                      00024 
003230                00025 event_pos1:
                      00026 
                      00027 ;       movf    FSR0H, w
                      00028 ;       call    SENDHEX
                      00029 ;       movf    FSR0L, w
                      00030 ;       call    SENDHEX
                      00031 ;       movlw   ':'
                      00032 ;       call    SENDCMNDP2
                      00033 ;
                      00034 ;       movf    INDF0, w
                      00035 ;       call    SENDHEX ; debug
                      00036 ;       movlw   ' '
                      00037 ;       call    SENDCMNDP2
                      00038 
                      00039 
003230 50EE           00040         movf    POSTINC0, w             ; fetch ADDR, get zero status
003232 B4D8           00041         btfsc   STATUS, Z               ; 0 (chain terminator)?
003234 0012           00042         return                                  ; if yes
                      00043 ;       movwf   ADDR                    ; else
                      00044 
                      00045 ;       call    SENDHEX ; debug
                      00046 ;       call    SENDCMNDP2CR
                      00047 
003236 50EE           00048         movf    POSTINC0, w             ; dummy read. Rc
003238 50EE           00049         movf    POSTINC0, w             ; dummy read. Gc
00323A 50EE           00050         movf    POSTINC0, w             ; dummy read. Bc
                      00051 
                      00052 
                      00053                                                         ; FSR0 currently = Rf
                      00054 
00323C EC8E F009      00055         call    get_rand                ; get next RNG entry
003240 6EEE           00056         movwf   POSTINC0                ; Rf
                      00057 ;       call    SENDHEX
003242 EC8E F009      00058         call    get_rand                ; get next RNG entry
003246 6EEE           00059         movwf   POSTINC0                ; Gf
                      00060 ;       call    SENDHEX
003248 EC8E F009      00061         call    get_rand                ; get next RNG entry
00324C 6EEE           00062         movwf   POSTINC0                ; Bf
                      00063 ;       call    SENDHEX
                      00064 ;       call    SENDCMNDP2CR
                      00065 
00324E 50EE           00066         movf    POSTINC0, w             ; dummy read (flags byte)
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 47


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00067 
003250 EF18 F019      00068         goto    event_pos1              ; this node written, next please...
                      00069 
                      00070 
                      00071 
                      00072 ; ----------------------------------------------
                      00073 ; Respond to a (high-to-low) positive interrupt event.
                      00074 ; Clear (R,G,B)f to every chain node.
                      00075 
003254                00076 event_neg:
003254 EE01 F000      00077         lfsr    FSR0, ADDRTBL   ; point to start of chain (first address)
                      00078 
                      00079 
                      00080 ;       movlw   H'04'   ;  FSR0 = (node)
                      00081 ;       addwf   FSR1L
                      00082 ;       clrf    WREG    ; FSR1 = (node+4)       (point to Rf)
                      00083 ;       addwfc  FSR1H           
                      00084 
003258                00085 event_neg1:
                      00086 
                      00087 
003258 50EE           00088         movf    POSTINC0, w             ; fetch ADDR, get zero status
00325A B4D8           00089         btfsc   STATUS, Z               ; 0 (chain terminator)?
00325C 0012           00090         return                                  ; if yes
                      00091 ;       movwf   ADDR                    ; else
                      00092 
                      00093 
00325E 50EE           00094         movf    POSTINC0, w             ; dummy read. Rc
003260 50EE           00095         movf    POSTINC0, w             ; dummy read. Gc
003262 50EE           00096         movf    POSTINC0, w             ; dummy read. Bc
                      00097 
                      00098 
                      00099                                                         ; FSR0 currently = Rf
                      00100 
003264 0E00           00101         movlw   0x00                    ; get next RNG entry
003266 6EEE           00102         movwf   POSTINC0                ; Rf
003268 6EEE           00103         movwf   POSTINC0                ; Gf
00326A 6EEE           00104         movwf   POSTINC0                ; Bf
                      00105 
00326C 50EE           00106         movf    POSTINC0, w             ; dummy read (flags byte)
                      00107 
00326E EF2C F019      00108         goto    event_neg1              ; this node written, next please...
                      00109 
003272 0012           00110         return
                      00308 
003274                00309 str_ready:
003274 4924 3A64 6D20 00310         DW      "$Id: main.asm,v I don't know, CVS server is broken... $\r\n\x00"
       6961 2E6E 7361 
       2C6D 2076 2049 
       6F64 276E 2074 
       6E6B 776F 202C 
       5643 2053 6573 
       7672 7265 6920 
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 48


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       2073 7262 6B6F 
       6E65 2E2E 202E 
       0D24 000A 
                      00311 
0032AE                00312 str_main_ver:
0032AE 4924 3A64 6D20 00313         DW      "$Id: main.asm,v 1.2 2005/07/31 21:31:31 tgipson Exp $\r\n\x00"
       6961 2E6E 7361 
       2C6D 2076 2E31 
       2032 3032 3530 
       302F 2F37 3133 
       3220 3A31 3133 
       333A 2031 6774 
       7069 6F73 206E 
       7845 2070 0D24 
       000A 
                      00314 
                      00315 
0032E6                00316 str_sent_cmd:
0032E6 6D43 2064 6573 00317         DW      "Cmd sent: \x00"
       746E 203A 0000 
                      00318 
                      00319 
0032F2                00320 str_chain:
0032F2 1817 2019 2221 00321         DW      "\x17\x18\x19\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x00"
       2423 2625 2827 
       0029 
                      00322 
                      00323 ; \x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x
                            20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20
                      00324         end
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 49


SYMBOL TABLE
  LABEL                             VALUE 

A                                 00000000
ABDEN                             00000000
ABDOVF                            00000007
ACCEL_PWR                         00000001
ACCEL_X                           00000000
ACCESS                            00000000
ACQT0                             00000003
ACQT1                             00000004
ACQT2                             00000005
ACTVIE                            00000002
ACTVIF                            00000002
ADC0                              00000017
ADC1                              00000016
ADC2                              00000015
ADC3                              00000014
ADCON0                            00000FC2
ADCON1                            00000FC1
ADCON2                            00000FC0
ADCS0                             00000000
ADCS1                             00000001
ADCS2                             00000002
ADDEN                             00000003
ADDR                              0000001F
ADDR0                             00000000
ADDR1                             00000001
ADDR2                             00000002
ADDR3                             00000003
ADDR4                             00000004
ADDR5                             00000005
ADDR6                             00000006
ADDRTBL                           00000100
ADEN                              00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADIP                              00000006
ADON                              00000000
ADRES                             00000FC3
ADRESH                            00000FC4
ADRESL                            00000FC3
AN0                               00000000
AN1                               00000001
AN10                              00000001
AN11                              00000004
AN12                              00000000
AN2                               00000002
AN3                               00000003
AN4                               00000005
AN8                               00000002
AN9                               00000003
ANALOGH                           00000018
ANALOGL                           00000019
ASCALPHA1                         00000DC6
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 50


SYMBOL TABLE
  LABEL                             VALUE 

ASCALPHA2                         00000DEE
ASCDIGIT1                         00000DD0
ASCDIGIT2                         00000DFA
ASCII2HEX                         00000DB6
BANKED                            00000001
BAUDCON                           00000FB8
BGST                              00000005
BOR                               00000000
BRG16                             00000003
BRGH                              00000002
BSR                               00000FE0
BTOEE                             00000004
BTOEF                             00000004
BTSEE                             00000007
BTSEF                             00000007
C                                 00000000
CCP1                              00000002
CCP1CON                           00000FBD
CCP1IE                            00000002
CCP1IF                            00000002
CCP1IP                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCPR1                             00000FBE
CCPR1H                            00000FBF
CCPR1L                            00000FBE
CFGS                              00000006
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CK                                00000006
COLOR                             0000001E
COMMAND                           00000020
CRC16EE                           00000002
CRC16EF                           00000002
CRC5EE                            00000001
CRC5EF                            00000001
CREN                              00000004
CSRC                              00000007
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DDRA                              TRISA
DDRB                              TRISB
DDRC                              TRISC
DDRD                              TRISD
DDRE                              TRISE
DFN8EE                            00000003
DFN8EF                            00000003
DIR                               00000002
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 51


SYMBOL TABLE
  LABEL                             VALUE 

DONE                              00000001
DONENIB                           00000E06
EEADDRH                           0000001A
EEADDRL                           0000001B
EECON1                            00000FA6
EECON2                            00000FA7
ENDP0                             00000003
ENDP1                             00000004
ENDP2                             00000005
ENDP3                             00000006
EPCONDIS                          00000003
EPHSHK                            00000004
EPINEN                            00000001
EPOUTEN                           00000002
EPSTALL                           00000000
FAST                              00000001
FERR                              00000002
FREE                              00000004
FRM0                              00000000
FRM1                              00000001
FRM10                             00000002
FRM2                              00000002
FRM3                              00000003
FRM4                              00000004
FRM5                              00000005
FRM6                              00000006
FRM7                              00000007
FRM8                              00000000
FRM9                              00000001
FSEN                              00000002
FSR0                              00000000
FSR0H                             00000FEA
FSR0L                             00000FE9
FSR1                              00000001
FSR1H                             00000FE2
FSR1L                             00000FE1
FSR2                              00000002
FSR2H                             00000FDA
FSR2L                             00000FD9
GETCMD                            00000D26
GIE                               00000007
GIEH                              00000007
GIEL                              00000006
GO                                00000001
GO_DONE                           00000001
HEXCONV                           00000006
HEXCONV1                          00000007
HEXTEMP                           00000008
HEXTEMP1                          00000009
HLVDCON                           00000FD2
HLVDEN                            00000004
HLVDIE                            00000002
HLVDIF                            00000002
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 52


SYMBOL TABLE
  LABEL                             VALUE 

HLVDIN                            00000005
HLVDIP                            00000002
HLVDL0                            00000000
HLVDL1                            00000001
HLVDL2                            00000002
HLVDL3                            00000003
IDLEIE                            00000004
IDLEIF                            00000004
IDLEN                             00000007
INDF0                             00000FEF
INDF1                             00000FE7
INDF2                             00000FDF
INITUSART                         00000CE6
INT0                              00000000
INT0E                             00000004
INT0F                             00000001
INT0IE                            00000004
INT0IF                            00000001
INT1                              00000001
INT1E                             00000003
INT1F                             00000000
INT1IE                            00000003
INT1IF                            00000000
INT1IP                            00000006
INT1P                             00000006
INT2                              00000002
INT2E                             00000004
INT2F                             00000001
INT2IE                            00000004
INT2IF                            00000001
INT2IP                            00000007
INT2P                             00000007
INTCON                            00000FF2
INTCON2                           00000FF1
INTCON3                           00000FF0
INTEDG0                           00000006
INTEDG1                           00000005
INTEDG2                           00000004
INTENS                            0000001D
INTENS_B                          00000023
INTENS_G                          00000022
INTENS_R                          00000021
IPEN                              00000007
IPR1                              00000F9F
IPR2                              00000FA2
IRVST                             00000005
ISCMD                             00000D30
IVRST                             00000005
KBI0                              00000004
KBI1                              00000005
KBI2                              00000006
KBI3                              00000007
LATA                              00000F89
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 53


SYMBOL TABLE
  LABEL                             VALUE 

LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA3                             00000003
LATA4                             00000004
LATA5                             00000005
LATA6                             00000006
LATB                              00000F8A
LATB0                             00000000
LATB1                             00000001
LATB2                             00000002
LATB3                             00000003
LATB4                             00000004
LATB5                             00000005
LATB6                             00000006
LATB7                             00000007
LATC                              00000F8B
LATC0                             00000000
LATC1                             00000001
LATC2                             00000002
LATC6                             00000006
LATC7                             00000007
LVDCON                            00000FD2
LVDEN                             00000004
LVDIE                             00000002
LVDIF                             00000002
LVDIN                             00000005
LVDIP                             00000002
LVDL0                             00000000
LVDL1                             00000001
LVDL2                             00000002
LVDL3                             00000003
LVV0                              00000000
LVV1                              00000001
LVV2                              00000002
LVV3                              00000003
N                                 00000004
NEXTNIB                           00000DDA
NOT_BOR                           00000000
NOT_DONE                          00000001
NOT_IPEN                          00000007
NOT_PD                            00000002
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RI                            00000004
NOT_T1SYNC                        00000002
NOT_TO                            00000003
NOT_UOE                           00000001
OERR                              00000001
OSC2                              00000006
OSCCON                            00000FD3
OSCFIE                            00000007
OSCFIF                            00000007
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 54


SYMBOL TABLE
  LABEL                             VALUE 

OSCFIP                            00000007
OSTS                              00000003
OV                                00000003
P1A                               00000002
PC                                00000FF9
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000FF9
PCLATH                            00000FFA
PCLATU                            00000FFB
PD                                00000002
PEIE                              00000006
PGC                               00000006
PGD                               00000007
PGM                               00000005
PIDEE                             00000000
PIDEF                             00000000
PIE1                              00000F9D
PIE2                              00000FA0
PIR1                              00000F9E
PIR2                              00000FA1
PKTDIS                            00000004
PLUSW0                            00000FEB
PLUSW1                            00000FE3
PLUSW2                            00000FDB
POR                               00000001
PORTA                             00000F80
PORTB                             00000F81
PORTC                             00000F82
PORTE                             00000F84
POSTDEC0                          00000FED
POSTDEC1                          00000FE5
POSTDEC2                          00000FDD
POSTINC0                          00000FEE
POSTINC1                          00000FE6
POSTINC2                          00000FDE
PPB0                              00000000
PPB1                              00000001
PPBI                              00000001
PPBRST                            00000006
PR2                               00000FCB
PREINC0                           00000FEC
PREINC1                           00000FE4
PREINC2                           00000FDC
PROD                              00000FF3
PRODH                             00000FF4
PRODL                             00000FF3
PSA                               00000003
RA0                               00000000
RA1                               00000001
RA2                               00000002
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 55


SYMBOL TABLE
  LABEL                             VALUE 

RA3                               00000003
RA4                               00000004
RA5                               00000005
RA6                               00000006
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RBIP                              00000000
RBPU                              00000007
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
RCIP                              00000005
RCMT                              00000006
RCON                              00000FD0
RCREG                             00000FAE
RCSTA                             00000FAB
RCV                               00000004
RD16                              00000007
RE3                               00000003
RESUME                            00000002
RI                                00000004
ROLLOVER                          0000001C
ROTATE                            00000001
RWDATA                            00000000
RX                                00000007
RX9                               00000006
RX9D                              00000000
SBOREN                            00000006
SCANCMD                           00000D38
SCKP                              00000004
SCRATCH0                          0000000C
SCRATCH1                          0000000D
SCRATCH2                          0000000E
SCRATCH3                          0000000F
SCRATCH4                          00000010
SCRATCH5                          00000011
SCRATCH6                          00000012
SCRATCH7                          00000013
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 56


SYMBOL TABLE
  LABEL                             VALUE 

SCS0                              00000000
SCS1                              00000001
SDIO                              00000F81
SDIOTRIS                          00000F93
SE0                               00000005
SENDB                             00000003
SENDBIN                           00000EBA
SENDCMD                           00000D0E
SENDCMNDP2                        00000D0E
SENDCMNDP2CR                      00000D18
SENDHEX                           00000D7C
SENDHEXALPHA                      00000DA2
SENDHEXNUM                        00000DAC
SENDNIB                           00000D94
SERR01                            0000000A
SERR02                            0000000B
SOFIE                             00000006
SOFIF                             00000006
SPBRG                             00000FAF
SPBRGH                            00000FB0
SPEN                              00000007
SREN                              00000005
STALLIE                           00000005
STALLIF                           00000005
STATUS                            00000FD8
STKFUL                            00000007
STKOVF                            00000007
STKPTR                            00000FFC
STKPTR0                           00000000
STKPTR1                           00000001
STKPTR2                           00000002
STKPTR3                           00000003
STKPTR4                           00000004
STKUNF                            00000006
SUSPND                            00000001
SWDTE                             00000000
SWDTEN                            00000000
SYNC                              00000004
S_DO                              00000003
T08BIT                            00000006
T0CKI                             00000004
T0CON                             00000FD5
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0IP                              00000002
T0PS0                             00000000
T0PS1                             00000001
T0PS2                             00000002
T0SE                              00000004
T1CKI                             00000000
T1CKPS0                           00000004
T1CKPS1                           00000005
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 57


SYMBOL TABLE
  LABEL                             VALUE 

T1CON                             00000FCD
T1OSCEN                           00000003
T1OSI                             00000001
T1OSO                             00000000
T1RUN                             00000006
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000FCA
T2OUTPS0                          00000003
T2OUTPS1                          00000004
T2OUTPS2                          00000005
T2OUTPS3                          00000006
TABLAT                            00000FF5
TBLPTR                            00000FF6
TBLPTRH                           00000FF7
TBLPTRL                           00000FF6
TBLPTRU                           00000FF8
TMR0H                             00000FD7
TMR0IE                            00000005
TMR0IF                            00000002
TMR0IP                            00000002
TMR0L                             00000FD6
TMR0ON                            00000007
TMR1CS                            00000001
TMR1H                             00000FCF
TMR1IE                            00000000
TMR1IF                            00000000
TMR1IP                            00000000
TMR1L                             00000FCE
TMR1ON                            00000000
TMR2                              00000FCC
TMR2IE                            00000001
TMR2IF                            00000001
TMR2IP                            00000001
TMR2ON                            00000002
TO                                00000003
TOS                               00000FFD
TOSH                              00000FFE
TOSL                              00000FFD
TOSU                              00000FFF
TRISA                             00000F92
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISA6                            00000006
TRISB                             00000F93
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 58


SYMBOL TABLE
  LABEL                             VALUE 

TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000F94
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC6                            00000006
TRISC7                            00000007
TRMT                              00000001
TRNIE                             00000003
TRNIF                             00000003
TX                                00000006
TX9                               00000006
TX9D                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXIP                              00000004
TXREG                             00000FAD
TXSTA                             00000FAC
UADDR                             00000F6E
UCFG                              00000F6F
UCON                              00000F6D
UEIE                              00000F6B
UEIR                              00000F6A
UEP0                              00000F70
UEP1                              00000F71
UEP10                             00000F7A
UEP11                             00000F7B
UEP12                             00000F7C
UEP13                             00000F7D
UEP14                             00000F7E
UEP15                             00000F7F
UEP2                              00000F72
UEP3                              00000F73
UEP4                              00000F74
UEP5                              00000F75
UEP6                              00000F76
UEP7                              00000F77
UEP8                              00000F78
UEP9                              00000F79
UERRIE                            00000001
UERRIF                            00000001
UFRM                              00000F66
UFRMH                             00000F67
UFRML                             00000F66
UIE                               00000F69
UIR                               00000F68
UOE                               00000001
UOEMON                            00000006
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 59


SYMBOL TABLE
  LABEL                             VALUE 

UPUEN                             00000004
URSTIE                            00000000
URSTIF                            00000000
USBEN                             00000003
USBIE                             00000005
USBIF                             00000005
USBIP                             00000005
USTAT                             00000F6C
UTEYE                             00000007
UTRDIS                            00000003
VCFG0                             00000004
VCFG1                             00000005
VDIRMAG                           00000007
VMO                               00000002
VPO                               00000003
VREFM                             00000002
VREFP                             00000003
W                                 00000000
WAITER                            00000005
WDTCON                            00000FD1
WR                                00000001
WREG                              00000FE8
WREN                              00000002
WRERR                             00000003
WUE                               00000001
Z                                 00000002
_BBSIZ_BB1K_4L                    000000FF
_BBSIZ_BB2K_4L                    000000F7
_BORV_21_2L                       000000FF
_BORV_28_2L                       000000F7
_BORV_43_2L                       000000EF
_BORV_46_2L                       000000E7
_BOR_OFF_2L                       000000F9
_BOR_ON_2L                        000000FF
_BOR_ON_ACTIVE_2L                 000000FD
_BOR_SOFT_2L                      000000FB
_CONFIG1H                         00300001
_CONFIG1L                         00300000
_CONFIG2H                         00300003
_CONFIG2L                         00300002
_CONFIG3H                         00300005
_CONFIG4L                         00300006
_CONFIG5H                         00300009
_CONFIG5L                         00300008
_CONFIG6H                         0030000B
_CONFIG6L                         0030000A
_CONFIG7H                         0030000D
_CONFIG7L                         0030000C
_CP0_OFF_5L                       000000FF
_CP0_ON_5L                        000000FE
_CP1_OFF_5L                       000000FF
_CP1_ON_5L                        000000FD
_CPB_OFF_5H                       000000FF
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 60


SYMBOL TABLE
  LABEL                             VALUE 

_CPB_ON_5H                        000000BF
_CPUDIV_OSC1_PLL2_1L              000000E7
_CPUDIV_OSC2_PLL3_1L              000000EF
_CPUDIV_OSC3_PLL4_1L              000000F7
_CPUDIV_OSC4_PLL6_1L              000000FF
_DEBUG_OFF_4L                     000000FF
_DEBUG_ON_4L                      0000007F
_DEVID1                           003FFFFE
_DEVID2                           003FFFFF
_EBTR0_OFF_7L                     000000FF
_EBTR0_ON_7L                      000000FE
_EBTR1_OFF_7L                     000000FF
_EBTR1_ON_7L                      000000FD
_EBTRB_OFF_7H                     000000FF
_EBTRB_ON_7H                      000000BF
_FCMEN_OFF_1H                     000000BF
_FCMEN_ON_1H                      000000FF
_FOSC_ECIO_EC_1H                  000000F4
_FOSC_ECPLLIO_EC_1H               000000F6
_FOSC_ECPLL_EC_1H                 000000F7
_FOSC_EC_EC_1H                    000000F5
_FOSC_HSPLL_HS_1H                 000000FE
_FOSC_HS_1H                       000000FC
_FOSC_INTOSCIO_EC_1H              000000F8
_FOSC_INTOSC_EC_1H                000000F9
_FOSC_INTOSC_HS_1H                000000FB
_FOSC_INTOSC_XT_1H                000000FA
_FOSC_XTPLL_XT_1H                 000000F2
_FOSC_XT_XT_1H                    000000F0
_ICPRT_OFF_4L                     000000DF
_ICPRT_ON_4L                      000000FF
_IDLOC0                           00200000
_IDLOC1                           00200001
_IDLOC2                           00200002
_IDLOC3                           00200003
_IDLOC4                           00200004
_IDLOC5                           00200005
_IDLOC6                           00200006
_IDLOC7                           00200007
_IESO_OFF_1H                      0000007F
_IESO_ON_1H                       000000FF
_LPT1OSC_OFF_3H                   000000FB
_LPT1OSC_ON_3H                    000000FF
_LVP_OFF_4L                       000000FB
_LVP_ON_4L                        000000FF
_MCLRE_OFF_3H                     0000007F
_MCLRE_ON_3H                      000000FF
_PBADEN_OFF_3H                    000000FD
_PBADEN_ON_3H                     000000FF
_PLLDIV_10_1L                     000000FE
_PLLDIV_12_1L                     000000FF
_PLLDIV_1_1L                      000000F8
_PLLDIV_2_1L                      000000F9
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 61


SYMBOL TABLE
  LABEL                             VALUE 

_PLLDIV_3_1L                      000000FA
_PLLDIV_4_1L                      000000FB
_PLLDIV_5_1L                      000000FC
_PLLDIV_6_1L                      000000FD
_PWRT_OFF_2L                      000000FF
_PWRT_ON_2L                       000000FE
_STVREN_OFF_4L                    000000FE
_STVREN_ON_4L                     000000FF
_USBDIV_1_1L                      000000DF
_USBDIV_2_1L                      000000FF
_VREGEN_OFF_2L                    000000DF
_VREGEN_ON_2L                     000000FF
_WDTPS_1024_2H                    000000F5
_WDTPS_128_2H                     000000EF
_WDTPS_16384_2H                   000000FD
_WDTPS_16_2H                      000000E9
_WDTPS_1_2H                       000000E1
_WDTPS_2048_2H                    000000F7
_WDTPS_256_2H                     000000F1
_WDTPS_2_2H                       000000E3
_WDTPS_32768_2H                   000000FF
_WDTPS_32_2H                      000000EB
_WDTPS_4096_2H                    000000F9
_WDTPS_4_2H                       000000E5
_WDTPS_512_2H                     000000F3
_WDTPS_64_2H                      000000ED
_WDTPS_8192_2H                    000000FB
_WDTPS_8_2H                       000000E7
_WDT_OFF_2H                       000000FE
_WDT_ON_2H                        000000FF
_WRT0_OFF_6L                      000000FF
_WRT0_ON_6L                       000000FE
_WRT1_OFF_6L                      000000FF
_WRT1_ON_6L                       000000FD
_WRTB_OFF_6H                      000000FF
_WRTB_ON_6H                       000000BF
_WRTC_OFF_6H                      000000FF
_WRTC_ON_6H                       000000DF
_XINST_OFF_4L                     000000BF
_XINST_ON_4L                      000000FF
__18F2450                         00000001
chain                             000012CE
chain_init                        000012CE
chain_init_2                      000012DE
chain_init_3                      000012F8
chain_loop                        00001306
colorchg                          000009F0
d1                                00000B0E
d2                                00000B0A
d2m1                              00000B2A
d2m2                              00000B26
d3                                00000B06
d4m1                              00000AEE
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 62


SYMBOL TABLE
  LABEL                             VALUE 

d4m2                              00000AEA
d4m3                              00000AE6
del1                              00000004
del2                              00000003
del3                              00000002
delay10_1                         00000C7E
delay20_1                         00000C72
delay20k                          00000B22
delay20msec                       00000BB8
delay20sec                        00000C06
delay40_1                         00000C66
delay68_1                         00000C96
delay8_1                          00000C8A
delay_10                          00000C7A
delay_20                          00000C6E
delay_40                          00000C62
delay_68                          00000C92
delay_8                           00000C86
delay_dt                          delay_68
delay_one                         delay_40
delay_zero                        delay_20
delayb1                           00000C5A
delayb1_wusb                      00000CA2
delaybit                          00000C58
delaybit_wusb                     00000C9E
delayhalfbit                      00000C62
delayhmsec                        00000B58
delayhsome                        00000B98
delaymsec                         00000B38
delaymsec4M                       00000AE2
delaysec                          00000B02
delaysome                         00000B78
dhm1                              00000B64
dhm2                              00000B60
dhm3                              00000B5C
dhs1                              00000BA4
dhs2                              00000BA0
dhs3                              00000B9C
diffuse                           00003172
diffuse1                          0000317E
diffuse2                          0000319E
diffuse2end                       000031AE
dm1                               00000B44
dm2                               00000B40
dm3                               00000B3C
ds1                               00000B84
ds2                               00000B80
ds3                               00000B7C
effect0                           00003100
effect1                           00003172
effect_set                        000031D6
effecttest                        0000091C
effecttest2                       00000940
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 63


SYMBOL TABLE
  LABEL                             VALUE 

effecttest_doit                   00000948
event_neg                         00003254
event_neg1                        00003258
event_pos                         0000322C
event_pos1                        00003230
fade                              00003100
fade1                             00003124
fade2                             00003130
fade_down                         00003142
fade_nextcolor                    00003156
fade_same                         0000314C
fade_send                         00003152
fade_up                           00003138
get_rand                          0000131C
getcmd                            00000D26
init                              000008A4
init_int_ADC                      00000EF8
init_ports                        00000A96
init_rand                         0000130E
intensloop                        000009CC
intensloop2                       000009E0
intensloop_dn                     000009E4
intensloop_up                     000009D4
iscmd                             00000D30
main                              0000099E
mathtest                          00000F34
pstrcpy                           
read_int_ADC                      00000ED8
read_int_ADC_chan                 00000ED4
read_int_ADC_wait                 00000EDA
rom_to_ram                        0000086C
rom_to_ram2                       00000878
send1wire                         00000F36
send1wire2                        00000F52
send1wire_byte                    00000F4C
send1wire_one                     00000F5A
send1wire_start                   00000F96
send1wire_zero                    00000F74
sendbin                           00000EBA
sendbin1                          00000EC0
sendcmdbyte                       000009FA
sendstrbyte                       00000864
sendstring                        
set1                              000031E6
set_int_ADC_chan                  00000EEA
showfsr                           00000EFE
start                             0000087E
stop                              00000A58
str_addr                          000012B8
str_chain                         000032F2
str_defs_ver                      00000E10
str_delay_ver                     00000AA8
str_dest_addr                     000012C0
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 64


SYMBOL TABLE
  LABEL                             VALUE 

str_hex_ver                       00000D40
str_main_ver                      000032AE
str_menu                          000011B2
str_menu_2                        00001230
str_menu_3                        00001274
str_ports                         00000A5C
str_rand                          00003000
str_ready                         00003274
str_sendbin_ver                   00000E7E
str_sent_cmd                      000032E6
str_string_ver                    0000081C
str_uart_ver                      00000CAA
str_vars_ver                      00000E48
stringsender                      00000858
test_adc                          000008C6
test_adc_neg                      000008EA
test_adc_pos                      000008F4
test_adc_show                     000008F8
testy                             00000890
ui_clear_event                    000010E8
ui_dec_addr                       0000107A
ui_inc_addr                       00001076
ui_inc_b                          00001152
ui_inc_color                      0000104C
ui_inc_color_x                    00001158
ui_inc_g                          0000114C
ui_inc_r                          00001146
ui_intens_dn                      00001060
ui_intens_up                      0000105C
ui_main_menu                      00000FA4
ui_main_menu_2                    00000FE4
ui_main_menu_scan                 00000FDE
ui_set_addr_0                     00001064
ui_set_addr_1                     0000106A
ui_set_addr_2                     00001070
ui_set_addr_x                     0000107E
ui_set_event                      000010E2
ui_set_full                       000010EE
ui_set_grp_addr                   000010AA
ui_set_none                       00001114
ui_show_addr                      00001180
ui_show_packet                    0000119C
ui_toggle_b                       00001058
ui_toggle_g                       00001054
ui_toggle_r                       00001050
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 65


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


0800 : XXXX------------ --------XXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0840 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0880 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
08C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0900 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0940 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0980 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
09C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0AC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0BC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0CC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0DC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0EC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0FC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
10C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
11C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
12C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXX---------- ----------------
3000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM  5.11                          MAIN.ASM   10-8-2007  15:37:40         PAGE 66


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


3040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
3080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
30C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
3100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
3140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
3180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
31C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
3200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
3240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
3280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
32C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX

All other memory blocks unused.

Program Memory Bytes Used:  3602
Program Memory Bytes Free: 12782


Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :     0 reported,     0 suppressed

Error[173]  : Source file path exceeds 62 characters (C:\DATA\PROJECTS\PICSOFT\10FBLINKY\NODE\CONTROLLER\STRING_M.INC)
Error[173]  : Source file path exceeds 62 characters (C:\DATA\PROJECTS\PICSOFT\10FBLINKY\NODE\CONTROLLER\4220UART.INC)
Error[173]  : Source file path exceeds 62 characters (C:\DATA\PROJECTS\PICSOFT\10FBLINKY\NODE\CONTROLLER\LCMHEX01.INC)
Error[173]  : Source file path exceeds 62 characters (C:\DATA\PROJECTS\PICSOFT\10FBLINKY\NODE\CONTROLLER\4220ANLG.INC)
